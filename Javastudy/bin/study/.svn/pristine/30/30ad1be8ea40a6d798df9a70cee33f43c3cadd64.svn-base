package kr.co.kt.common;

import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.util.List;

import javax.inject.Inject;

import javax.mail.MessagingException;
import javax.mail.internet.AddressException;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMessage.RecipientType;
import javax.servlet.http.HttpSession;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.mail.javamail.JavaMailSender;
import org.springframework.stereotype.Component;

import kr.co.kt.agwne.dto.BusinessVO;
import kr.co.kt.agwne.dto.ConfirmUserVO;
import kr.co.kt.agwne.dto.EmailVO;
import kr.co.kt.agwne.dto.ModelInfoVO;
import kr.co.kt.agwne.dto.ProcessVO;
import kr.co.kt.agwne.dto.ReplyVO;
import kr.co.kt.agwne.dto.UserInfoVO;
import kr.co.kt.agwne.service.CommonService;

/**
 * agw-ne
 *
 * Copyright ⓒ 2018 kt corp. All rights reserved.
 *
 * This is a proprietary software of kt corp, and you may not use this file
 * except in compliance with license agreement with kt corp. Any redistribution
 * or use of this software, with or without modification shall be strictly
 * prohibited without prior written approval of kt corp, and the copyright
 * notice above does not evidence any actual or intended publication of such
 * software.
 * 
 * @ author kt @ since 2010-11-22 @ file UserApprValidation.java @ version 1.0 @
 * see @ Copyright ⓒ 2018 By kt corp. All rights reserved.
 */
@Component
public class EmailSender extends ParamValidatChk {

	private static final Logger logger = LoggerFactory.getLogger(EmailSender.class);

	@Autowired
	private JavaMailSender mailSender;
	@Autowired
	private HttpSession session;
	@Inject
	CommonService service;

	private final String url = "neoss-ne.kt.co.kr";

	public void sendEmail(EmailVO vo) {
		MimeMessage msg = mailSender.createMimeMessage();

		try {
			msg.setFrom(new InternetAddress("AGW-Ne@kt.com", "AGW-Ne"));
			msg.setSubject(vo.getSubject());
			String[] receiver = vo.getReceiver();
			String[] receiverCC = vo.getReceiverCC();
			String[] receiverBCC = vo.getReceiverBCC();
			for (int i = 0; i < receiver.length; i++) {
//				logger.info("EmailSender==========다음단계승인자==> "+ receiver[i]);
				msg.addRecipient(RecipientType.TO, new InternetAddress(receiver[i]));
			}
			if (receiverCC != null) {
				for (int i = 0; i < receiverCC.length; i++) {
//					logger.info("EmailSender==========참조인==> "+ receiverCC[i]);
					msg.addRecipient(RecipientType.CC, new InternetAddress(receiverCC[i]));
				}
			}
			if (receiverBCC != null) {
				for (int i = 0; i < receiverBCC.length; i++) {
//					logger.info("EmailSender==========메일링리스트==> "+ receiverBCC[i]);
					msg.addRecipient(RecipientType.BCC, new InternetAddress(receiverBCC[i]));
				}
			}
			msg.setContent(vo.getContent(), "text/html; charset=utf-8");
		} catch (AddressException e) {
			logger.info("EmailSender==========sendEmail============================> AddressException");
		} catch (MessagingException e) {
			logger.info("EmailSender==========sendEmail============================> MessagingException");
		} catch (Exception e) {
			e.printStackTrace();
		}
		vo.setInput_id((String) session.getAttribute("user_id"));
		
		//mailSender(msg, vo);
		service.insertEmail(vo);
	}

	private void mailSender(MimeMessage msg, EmailVO vo) {
		mailSender.send(msg);
		service.insertEmail(vo);
//		logger.info("EmailSender==========sendEmail============================>send() Complete()");
	}

	public String r_getEmailContent01(BusinessVO vo, List<ConfirmUserVO> cfList, String title, List<ProcessVO> psVO) {
		StringBuffer sb = new StringBuffer();
		sb.append("<div style=\"width: 630px; margin:0; padding: 0;\">\r\n ");
		sb.append(
				"    <div style=\"padding: 10px 20px; font-family: 'malgunGothic'; font-size: 12pt; font-weight: bold; \">\r\n ");
		sb.append("        아래와 같이 Reform-AGW 수요 공급에 대해 <span style=\"color:red; \">'" + title + "'</span>되었습니다.\r\n ");
		if (!(vo.getStatus_cd().equals("02") && vo.getRequest_yn())) {
			sb.append("<br>검토 처리 부탁드립니다. \r\n");
		}
		sb.append("    </div>\r\n ");
		sb.append("    <div style=\" border: 1px dashed #666; padding-bottom: 20px; \">\r\n ");
		sb.append("        <div style=\"display:block; height: 55px; padding: 10px; \">\r\n ");
		sb.append("            <h3 style=\"float: left; margin: 0;\">\r\n ");
		sb.append("                <span style=\"font-size: 38pt; font-weight: bolder\">kt</span>&nbsp;\r\n ");
		sb.append(
				"                <span style=\"font-family:Verdana; letter-spacing: -1.5px; font-size: 20pt; \"><strong style=\"color:#993399\">AGW</strong>-Ne</span>\r\n ");
		sb.append("            </h3>\r\n ");
		sb.append(
				"            <h3 style=\"float: right; margin: 0; vertical-align: bottom; font-size:12pt; font-family:'Trebuchet MS', sans-serif; font-weight: bolder; letter-spacing: -2px; color: #666; \">수요 공급 요청</h3>\r\n ");
		sb.append("        </div>\r\n ");
		sb.append("        <div style=\"clear:both; background-color:#666; padding: 10px 20px; height: 17px;\">\r\n ");
		sb.append(
				"            <span style=\"font-size:9pt; font-family:'Trebuchet MS', sans-serif; font-weight: bold; color: #CECECE; float: left;  \">"
						+ vo.getOffice_nm() + "</span>\r\n ");
		sb.append(
				"            <span style=\"font-size:9pt; font-family:'Trebuchet MS', sans-serif; font-weight: bold; color: #CECECE; float: right;\">요청번호 : "
						+ vo.getDoc_no() + "</span>\r\n ");
		sb.append("        </div>\r\n ");
		sb.append(
				"        <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"margin:0; padding:0; width:100%;\">\r\n ");
		sb.append("            <tr>\r\n ");
		sb.append(
				"                <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">요청자</th>\r\n ");
		sb.append(
				"                <td style=\"width:200px ;padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
						+ vo.getEmp_name() + "</td>\r\n ");
		sb.append(
				"                <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">요청일</th>\r\n ");
		sb.append(
				"                <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
						+ vo.getInput_dt() + "</td>\r\n ");
		sb.append("            </tr>\r\n ");
		sb.append("            <tr>\r\n ");
		sb.append(
				"                <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급구분</th>\r\n ");
		sb.append(
				"                <td colspan=\"3\" style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
						+ vo.getSupply_cd() + "</td>\r\n ");
		sb.append("            </tr>\r\n ");
		sb.append("            <tr>\r\n ");
		sb.append(
				"                <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급내역</th>\r\n ");
		sb.append(
				"                <td colspan=\"3\" style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
						+ vo.getModel_nm() + "</td>\r\n ");
		sb.append("            </tr>\r\n ");
		sb.append("            <tr>\r\n ");
		sb.append(
				"                <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급회선</th>\r\n ");
		sb.append(
				"                <td colspan=\"3\" style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
						+ vo.getModel_num() + " 회선</td>\r\n ");
		sb.append("            </tr>\r\n ");
		sb.append("            <tr>\r\n ");
		sb.append("                <td colspan=\"4\" style=\"padding:0;\">\r\n ");
		sb.append(
				"                    <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"width:100%\">\r\n ");
		sb.append("                        <tr>\r\n ");
		for (int i = 0; i < cfList.size(); i++) {
			sb.append(
					"                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">"
							+ cfList.get(i).getStatus() + " 승인</th>\r\n");
		}
		sb.append("                        </tr>\r\n ");
		sb.append("                        <tr>\r\n ");
		for (int i = 0; i < cfList.size(); i++) {
			sb.append(
					"                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
							+ cfList.get(i).getBonbu_name() + "<br>" + cfList.get(i).getOrg_name() + "<br>"
							+ cfList.get(i).getEmp_name() + "<br><span style=\"font-size:8pt; letter-spacing: -1px;\">"
							+ cfList.get(i).getPhone_number() + "</span></td>\r\n");
		}
		sb.append("                        </tr>\r\n ");
		if (!isNull(psVO)) {
			for (int i = 0; i < psVO.size(); i++) {
				sb.append("        <tr>\r\n ");
				sb.append(
						"            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">"
								+ psVO.get(i).getStatus() + "</th>\r\n ");
				sb.append(
						"            <td colspan=\"3\" style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">\r\n ");
				sb.append("                <div style=\"font-size: 8pt; margin-bottom: 5px;\"><b>"
						+ psVO.get(i).getEmp_name() + " (" + psVO.get(i).getPhone_number() + ")</b> - "
						+ psVO.get(i).getOffice_nm() + "</div>\r\n ");
				sb.append("                <div>" + psVO.get(i).getContents() + "</div>\r\n ");
				sb.append("            </td>\r\n ");
				sb.append("        </tr>\r\n ");
			}
		}
		sb.append("                    </table>\r\n ");
		sb.append("                </td>\r\n ");
		sb.append("            </tr>\r\n ");
		sb.append("        </table>\r\n ");
		sb.append("        <div style=\"text-align:center; margin-top: 20px; \">\r\n ");
		sb.append("        <a href=\"http://" + url
				+ "\"><span style=\"padding:10px 30px; -webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px; background-color: #5f115d; border: 1px solid  #5f115d; color: #FFFFFF; font-size: 12pt;\">바로가기</span></a>\r\n ");
		sb.append("        </div>\r\n ");
		sb.append("    </div>\r\n ");
		sb.append("</div>\r\n ");
		return sb.toString();
	}

	public String getEmailContent01(BusinessVO vo, List<ConfirmUserVO> cfList, String title, List<ProcessVO> psVO) {
		DecimalFormat currency = new DecimalFormat("#,##0");

		StringBuffer sb = new StringBuffer();
		/****/
		sb.append("<div style=\"width: 630px; margin:0; padding: 0;\">\r\n ");
		sb.append(
				"    <div style=\"padding: 10px 20px; font-family: 'malgunGothic'; font-size: 12pt; font-weight: bold; \">\r\n ");
		sb.append("        아래와 같이 AGW 수요 공급에 대해 <span style=\"color:red; \">'" + title + "'</span>되었습니다. \r\n ");
		if (!(vo.getStatus_cd().equals("06") && vo.getRequest_yn())) {
			sb.append("<br>검토 처리 부탁드립니다. \r\n");
		}
		sb.append("    </div>\r\n ");
		sb.append("    <div style=\" border: 1px dashed #666; padding-bottom: 20px; \">\r\n ");
		sb.append("    <div style=\"display:block; height: 55px; padding: 10px; \">\r\n ");
		sb.append("        <h3 style=\"float: left; margin: 0;\">\r\n ");
		sb.append("            <span style=\"font-size: 38pt; font-weight: bolder\">kt</span>&nbsp;\r\n ");
		sb.append(
				"            <span style=\"font-family:Verdana; letter-spacing: -1.5px; font-size: 20pt; \"><strong style=\"color:#993399\">AGW</strong>-Ne</span>\r\n ");
		sb.append("        </h3>\r\n ");
		sb.append(
				"        <h3 style=\"float: right; margin: 0; vertical-align: bottom; font-size:12pt; font-family:'Trebuchet MS', sans-serif; font-weight: bolder; letter-spacing: -2px; color: #666; \">수요 공급 요청</h3>\r\n ");
		sb.append("    </div>\r\n ");
		sb.append("    <div style=\"clear:both; background-color:#666; padding: 10px 20px; height: 17px;\">\r\n ");
		sb.append(
				"        <span style=\"font-size:9pt; font-family:'Trebuchet MS', sans-serif; font-weight: bold; color: #CECECE; float: left;  \">"
						+ vo.getOffice_nm() + "</span>\r\n ");
		sb.append(
				"        <span style=\"font-size:9pt; font-family:'Trebuchet MS', sans-serif; font-weight: bold; color: #CECECE; float: right;\">요청번호 : "
						+ vo.getDoc_no() + "</span>\r\n ");
		sb.append("    </div>\r\n ");
		sb.append(
				"    <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"margin:0; padding:0; width:100%;\">\r\n ");
		sb.append("        <tr>\r\n ");
		sb.append(
				"            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">요청자</th>\r\n ");
		sb.append(
				"            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
						+ vo.getEmp_name() + "</td>\r\n ");
		sb.append(
				"            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">요청일</th>\r\n ");
		sb.append(
				"            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
						+ vo.getInput_dt() + "</td>\r\n ");
		sb.append("        </tr>\r\n ");
		sb.append("        <tr>\r\n ");
		sb.append(
				"            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">건물형태</th>\r\n ");
		sb.append(
				"            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
						+ vo.getBuild_nm() + " > " + vo.getBuildshape_nm() + " > " + vo.getSection_nm() + "</td>\r\n ");
		sb.append(
				"            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">입주예정일</th>\r\n ");
		sb.append(
				"            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
						+ vo.getMove_dt() + "</td>\r\n ");
		sb.append("        </tr>\r\n ");
		sb.append("        <tr>\r\n ");
		sb.append(
				"            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">설치주소</th>\r\n ");
		sb.append(
				"            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">("
						+ vo.getPost() + ") " + vo.getAddress1() + " " + vo.getAddress2() + "</td>\r\n ");
		sb.append(
				"            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급일</th>\r\n ");
		sb.append(
				"            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
						+ vo.getSupply_dt() + "</td>\r\n ");
		sb.append("        </tr>\r\n ");
		sb.append("        <tr>\r\n ");
		sb.append(
				"            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급사유</th>\r\n ");
		sb.append(
				"            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
						+ vo.getReason_nm());
		if (!isNull(vo.getReason())) {
			sb.append("<br>(상세사유 : " + vo.getReason() + ")");
		}
		sb.append("</td>\r\n ");
		sb.append(
				"            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급구분</th>\r\n ");
		sb.append(
				"            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
						+ vo.getSupply_cd() + "</td>\r\n ");
		sb.append("        </tr>\r\n ");
		sb.append("        <tr>\r\n ");
		sb.append(
				"            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급회선</th>\r\n ");
		sb.append("            <td colspan=\"3\" style=\"padding:0;\">\r\n ");
		sb.append("                <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"width:100%\">\r\n ");
		sb.append("                    <tr>\r\n ");
		sb.append(
				"                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">세대수</th>\r\n ");
		sb.append(
				"                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">시장점유율</th>\r\n ");
		sb.append(
				"                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급회선</th>\r\n ");
		sb.append("                    </tr>\r\n ");
		sb.append("                    <tr>\r\n ");
		sb.append(
				"                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
						+ vo.getHousehold_no() + "</td>\r\n ");
		sb.append(
				"                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
						+ vo.getShare_nm() + "</td>\r\n ");
		sb.append(
				"                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
						+ vo.getModel_num() + " 회선</td>\r\n ");
		sb.append("                    </tr>\r\n ");
		sb.append("                </table>\r\n ");
		sb.append("            </td>\r\n ");
		sb.append("        </tr>\r\n ");
		sb.append("        <tr>\r\n ");
		sb.append(
				"            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급내역</th>\r\n ");
		sb.append(
				"            <td colspan=\"3\" style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
						+ vo.getModel_nm() + "</td>\r\n ");
		sb.append("        </tr>\r\n ");
		sb.append("        <tr>\r\n ");
		sb.append(
				"            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">소요경비</th>\r\n ");
		sb.append("            <td colspan=\"3\" style=\"padding:0;\">\r\n ");
		sb.append("                <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"width:100%\">\r\n ");
		sb.append("                    <tr>\r\n ");
		sb.append(
				"                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">물자비</th>\r\n ");
		sb.append(
				"                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공사비</th>\r\n ");
		sb.append(
				"                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">경비</th>\r\n ");
		sb.append(
				"                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">합계</th>\r\n ");
		sb.append("                    </tr>\r\n ");
		sb.append("                    <tr>\r\n ");
		sb.append(
				"                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
						+ currency.format(vo.getExpense1()) + "</td>\r\n ");
		sb.append(
				"                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
						+ currency.format(vo.getExpense2()) + "</td>\r\n ");
		sb.append(
				"                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
						+ currency.format(vo.getExpense3()) + "</td>\r\n ");
		sb.append(
				"                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
						+ currency.format(vo.getTot_expense()) + "</td>\r\n ");
		sb.append("                    </tr>\r\n ");
		sb.append("                </table>\r\n ");
		sb.append("            </td>\r\n ");
		sb.append("        </tr>\r\n ");
		sb.append("        <tr>\r\n ");
		sb.append("            <td colspan=\"4\" style=\"padding:0;\">\r\n ");
		sb.append("                <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"width:100%\">\r\n ");
		sb.append("                    <tr>\r\n ");
		for (int i = 0; i < cfList.size(); i++) {
			sb.append(
					"                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">"
							+ cfList.get(i).getStatus() + "</th>\r\n");
		}
		/*
		 * sb.
		 * append("                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">투자확정</th>\r\n "
		 * ); sb.
		 * append("                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">IP확정</th>\r\n "
		 * ); sb.
		 * append("                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">MGID확정</th>\r\n "
		 * ); sb.
		 * append("                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">COLCODE<br>확정</th>\r\n "
		 * ); sb.
		 * append("                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">장비정보<br>확정</th>\r\n "
		 * ); sb.
		 * append("                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">착공</th>\r\n "
		 * ); sb.
		 * append("                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">준공</th>\r\n "
		 * );
		 */
		sb.append("                    </tr>\r\n ");
		sb.append("                    <tr>\r\n ");
		for (int i = 0; i < cfList.size(); i++) {
			sb.append(
					"                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
							+ cfList.get(i).getBonbu_name() + "<br>" + cfList.get(i).getOrg_name() + "<br>"
							+ cfList.get(i).getEmp_name() + "<br><span style=\"font-size:8pt; letter-spacing: -1px;\">"
							+ cfList.get(i).getPhone_number() + "</span></td>\r\n");
		}
		/*
		 * sb.
		 * append("                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">강지성<br><span style=\"font-size:8pt; letter-spacing: -1px;\">010-1234-5678</span></td>\r\n "
		 * ); sb.
		 * append("                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">강지성<br><span style=\"font-size:8pt; letter-spacing: -1px;\">010-1234-5678</span></td>\r\n "
		 * ); sb.
		 * append("                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">강지성<br><span style=\"font-size:8pt; letter-spacing: -1px;\">010-1234-5678</span></td>\r\n "
		 * ); sb.
		 * append("                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">강지성<br><span style=\"font-size:8pt; letter-spacing: -1px;\">010-1234-5678</span></td>\r\n "
		 * ); sb.
		 * append("                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">강지성<br><span style=\"font-size:8pt; letter-spacing: -1px;\">010-1234-5678</span></td>\r\n "
		 * ); sb.
		 * append("                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">강지성<br><span style=\"font-size:8pt; letter-spacing: -1px;\">010-1234-5678</span></td>\r\n "
		 * ); sb.
		 * append("                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">강지성<br><span style=\"font-size:8pt; letter-spacing: -1px;\">010-1234-5678</span></td>\r\n "
		 * );
		 */
		sb.append("                    </tr>\r\n ");
		sb.append("                </table>\r\n ");
		sb.append("            </td>\r\n ");
		sb.append("        </tr>\r\n ");
		if (!isNull(psVO)) {
			for (int i = 0; i < psVO.size(); i++) {
				sb.append("        <tr>\r\n ");
				sb.append(
						"            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">"
								+ psVO.get(i).getStatus() + "</th>\r\n ");
				sb.append(
						"            <td colspan=\"3\" style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">\r\n ");
				sb.append("                <div style=\"font-size: 8pt; margin-bottom: 5px;\"><b>"
						+ psVO.get(i).getEmp_name() + " (" + psVO.get(i).getPhone_number() + ")</b> - "
						+ psVO.get(i).getOffice_nm() + "</div>\r\n ");
				sb.append("                <div>" + psVO.get(i).getContents() + "</div>\r\n ");
				sb.append("            </td>\r\n ");
				sb.append("        </tr>\r\n ");
			}
		}
		sb.append("    </table>\r\n ");
		sb.append("    <div style=\"text-align:center; margin-top: 20px; \">\r\n ");
		sb.append("        <a href=\"http://" + url
				+ "\"><span style=\"padding:10px 30px; -webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px; background-color: #5f115d; border: 1px solid  #5f115d; color: #FFFFFF; font-size: 12pt;\">바로가기</span></a>\r\n ");
		sb.append("    </div>\r\n ");
		sb.append("    </div>\r\n ");
		sb.append("</div>\r\n ");

		return sb.toString();
	}

	// 4P 이메일
	public String getEmailContent03(BusinessVO vo, ModelInfoVO mdVO, String title, List<ProcessVO> psList,
			List<UserInfoVO> list01, List<UserInfoVO> list02, List<UserInfoVO> list03, List<UserInfoVO> list04,
			List<UserInfoVO> list05) {
		logger.info(vo.getStatus_cd());
		DecimalFormat currency = new DecimalFormat("#,##0");
		String agree_yn = vo.isAgree_yn() ? "완료" : "미완료";
		String power_yn = vo.isPower_yn() ? "필요" : "불필요";
		String direct_yn = vo.isDirect_yn() ? "직영(협력사에 메일 발송 안됨)" : "-";
		String html = "<div style=\"width: 700px; margin:0; padding: 0;\">\r\n"
				+ "    <div style=\"padding: 10px 20px; font-family: 'malgunGothic'; font-size: 12pt; font-weight: bold; \">\r\n"
				+ "        아래와 같이 4P-AGW 수요 공급에 대해 <span style=\"color:red; \">'" + title + "'</span>되었습니다. ";
		if (!(vo.getStatus_cd().equals("05") && vo.getRequest_yn())) {
			html += "<br>검토 처리 부탁드립니다. \r\n";
		}
		html += "    </div>\r\n" + "    <div style=\" border: 1px dashed #666; padding-bottom: 20px; \">\r\n"
				+ "    <div style=\"display:block; height: 55px; padding: 10px; \">\r\n"
				+ "        <h3 style=\"float: left; margin: 0;\">\r\n"
				+ "            <span style=\"font-size: 38pt; font-weight: bolder\">kt</span>&nbsp;\r\n"
				+ "            <span style=\"font-family:Verdana; letter-spacing: -1.5px; font-size: 20pt; \"><strong style=\"color:#993399\">AGW</strong>-Ne</span>\r\n"
				+ "        </h3>\r\n"
				+ "        <h3 style=\"float: right; margin: 0; vertical-align: bottom; font-size:12pt; font-family:'Trebuchet MS', sans-serif; font-weight: bolder; letter-spacing: -2px; color: #666; \">수요 공급 요청</h3>\r\n"
				+ "    </div>\r\n" + "\r\n"
				+ "    <div style=\"clear:both; background-color:#666; padding: 10px 20px; height: 17px;\">\r\n"
				+ "        <span style=\"font-size:9pt; font-family:'Trebuchet MS', sans-serif; font-weight: bold; color: #CECECE; float: left;  \">"
				+ vo.getOffice_nm() + "</span>\r\n"
				+ "        <span style=\"font-size:9pt; font-family:'Trebuchet MS', sans-serif; font-weight: bold; color: #CECECE; float: right;\">요청번호 : "
				+ vo.getDoc_no() + "</span>\r\n" + "    </div>\r\n"
				+ "    <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"margin:0; padding:0; width:100%;\">\r\n"
				+ "        <tr>\r\n"
				+ "            <th style=\"width: 80px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">요청자</th>\r\n"
				+ "            <td style=\"width: 250px; padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
				+ vo.getEmp_name() + "</td>\r\n"
				+ "            <th style=\"width: 80px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">요청일</th>\r\n"
				+ "            <td style=\"width: 110px; padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
				+ vo.getInput_dt() + "</td>\r\n" + "        </tr>\r\n" + "        <tr>\r\n"
				+ "            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">건물형태</th>\r\n"
				+ "            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
				+ vo.getBuild_nm() + " > " + vo.getBuildshape_nm() + " > " + vo.getSection_nm() + "</td>\r\n"
				+ "            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급일</th>\r\n"
				+ "            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
				+ vo.getSupply_dt() + "</td>\r\n" + "        </tr>\r\n" + "        <tr>\r\n"
				+ "            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">설치주소</th>\r\n"
				+ "            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">("
				+ vo.getPost() + ") " + vo.getAddress_old() + " " + vo.getAddress2() + "</td>\r\n"
				+ "            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급직영여부</th>\r\n"
				+ "            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
				+ direct_yn + "</td>\r\n" + "        </tr>\r\n" + "        <tr>\r\n"
				+ "            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급사유</th>\r\n"
				+ "            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
				+ vo.getReason_nm();
		if (!isEmpty(vo.getReason())) {
			html += "<br>(상세사유 : " + vo.getReason() + ")";
		}
		html += "		</td>\r\n"
				+ "            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급구분</th>\r\n"
				+ "            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
				+ vo.getSupply_cd() + "</td>\r\n" + "        </tr>\r\n" + "        <tr>\r\n"
				+ "            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">청약전화번호</th>\r\n"
				+ "            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
				+ toTelNumSecurity(vo.getTelnum()) + "</td>\r\n"
				+ "            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">OSPIA번호</th>\r\n"
				+ "            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
				+ vo.getOspia() + "</td>\r\n" + "        </tr>\r\n" + "        <tr>\r\n"
				+ "            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">INET-Tie</th>\r\n"
				+ "            <td colspan=\"3\" style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
				+ mdVO.getInet_tie() + "</td>\r\n" + "        </tr>\r\n" + "        <tr>\r\n"
				+ "            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급회선</th>\r\n"
				+ "            <td colspan=\"3\" style=\"padding:0;\">\r\n"
				+ "                <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"width:100%\">\r\n"
				+ "                    <tr>\r\n"
				+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">세대수</th>\r\n"
				+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">시장점유율</th>\r\n"
				+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급회선</th>\r\n"
				+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급장비</th>\r\n"
				+ "                    </tr>\r\n" + "                    <tr>\r\n"
				+ "                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
				+ vo.getHousehold_no() + "</td>\r\n"
				+ "                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
				+ vo.getShare_nm() + "</td>\r\n"
				+ "                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
				+ vo.getModel_num() + "회선</td>\r\n"
				+ "                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
				+ vo.getModel_nm() + "</td>\r\n" + "                    </tr>\r\n" + "                </table>\r\n"
				+ "            </td>\r\n" + "        </tr>\r\n" + "        <tr>\r\n"
				+ "            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공급내역</th>\r\n"
				+ "            <td colspan=\"3\" style=\"padding:0;\">\r\n"
				+ "                <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"width:100%\">\r\n"
				+ "                    <tr>\r\n"
				+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">장비수</th>\r\n"
				+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">선로방식</th>\r\n"
				+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">전원협정여부</th>\r\n"
				+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">전원공사</th>\r\n"
				+ "                    </tr>\r\n" + "                    <tr>\r\n"
				+ "                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
				+ vo.getDevice_num() + "대</td>\r\n"
				+ "                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
				+ vo.getLine_type() + "차 RN</td>\r\n"
				+ "                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
				+ agree_yn + "</td>\r\n"
				+ "                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
				+ power_yn + "</td>\r\n" + "                    </tr>\r\n" + "                </table>\r\n"
				+ "            </td>\r\n" + "        </tr>\r\n";
		if (!(vo.getStatus_cd().equals("04"))) {
			html += "        <tr>\r\n"
					+ "            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">소요경비(원)</th>\r\n"
					+ "            <td colspan=\"3\" style=\"padding:0;\">\r\n"
					+ "                <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"width:100%\">\r\n"
					+ "                    <tr>\r\n"
					+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">물자비</th>\r\n"
					+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">공사비</th>\r\n"
					+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">경비</th>\r\n"
					+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">합계</th>\r\n"
					+ "                    </tr>\r\n" + "                    <tr>\r\n"
					+ "                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
					+ currency.format(vo.getExpense1()) + "</td>\r\n"
					+ "                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
					+ currency.format(vo.getExpense2()) + "</td>\r\n"
					+ "                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
					+ currency.format(vo.getExpense3()) + "</td>\r\n"
					+ "                        <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\"><b>"
					+ currency.format(vo.getTot_expense()) + "</b></td>\r\n" + "                    </tr>\r\n"
					+ "                </table>\r\n" + "            </td>\r\n" + "        </tr>\r\n";
		}
		if (!isEmpty(mdVO.getKuksa_nm())) {
			html += "        <tr><th colspan=\"4\" style=\"border-top: 3px double #CCC\"></th></tr>\r\n"
					+ "            <tr>\r\n"
					+ "                <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">OLT정보</th>\r\n"
					+ "                <td colspan=\"3\" style=\"padding:0;\">\r\n"
					+ "                    <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"width:100%; table-layout: fixed;\">\r\n"
					+ "                        <tr>\r\n"
					+ "                            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">OLT IP<br>(고정 IP)</th>\r\n"
					+ "                            <td style=\"width: 85px; padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
					+ mdVO.getManaged_ip() + "</td>\r\n"
					+ "                            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">GATEWAY</th>\r\n"
					+ "                            <td style=\"width: 80px; padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
					+ mdVO.getGw_ip() + "</td>\r\n"
					+ "                            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">SUBNET</th>\r\n"
					+ "                            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">/ "
					+ mdVO.getSubnetmask() + "</td>\r\n" + "                        </tr>\r\n"
					+ "                        <tr>\r\n"
					+ "                            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">설치국사</th>\r\n"
					+ "                            <td style=\"width: 80px; padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
					+ mdVO.getKuksa_nm() + "</td>\r\n"
					+ "                            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">OLT 이름</th>\r\n"
					+ "                            <td colspan=\"3\" style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
					+ mdVO.getOlt_nm() + "</td>\r\n" + "                        </tr>\r\n"
					+ "                    </table>\r\n" + "                </td>\r\n" + "            </tr>\r\n";
		}
		if (!isEmpty(mdVO.getPots_user_id())) {
			html += "            <tr>\r\n"
					+ "                <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">POTS정보</th>\r\n"
					+ "                <td colspan=\"3\" style=\"padding:0;\">\r\n"
					+ "                    <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"width:100%; table-layout: fixed;\">\r\n"
					+ "                        <tr>\r\n"
					+ "                            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">POTS</th>\r\n"
					+ "                            <td style=\"width: 85px; padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
					+ mdVO.getPots_nm() + " (" + mdVO.getPots_ip() + ")</td>\r\n"
					+ "                            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">MGID</th>\r\n"
					+ "                            <td style=\"width: 80px; padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
					+ mdVO.getMg_id() + "</td>\r\n"
					+ "                            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">START LLN</th>\r\n"
					+ "                            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
					+ mdVO.getStart_lln() + "</td>\r\n" + "                        </tr>\r\n"
					+ "                        <tr>\r\n"
					+ "                            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">AGW IP</th>\r\n"
					+ "                            <td style=\"width: 85px; padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
					+ mdVO.getMegaco_ip() + "</td>\r\n"
					+ "                            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">IPSec 서버IP</th>\r\n"
					+ "                            <td style=\"width: 80px; padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
					+ mdVO.getIpsec_ip() + "</td>\r\n"
					+ "                            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">EMS IP</th>\r\n"
					+ "                            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">"
					+ mdVO.getMih_ip() + "<br>(" + mdVO.getKtis_ip() + ")</td>\r\n"
					+ "                        </tr>\r\n" + "                    </table>\r\n"
					+ "                </td>\r\n" + "            </tr>\r\n";
		}
		if (!isEmpty(mdVO.getMac_user_id())) {
			html += "            <tr>\r\n"
					+ "                <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">MAC 정보</th>\r\n"
					+ "                <td colspan=\"3\" style=\"padding: 0;\">\r\n"
					+ "                    <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"width:100%; table-layout: fixed;\">\r\n"
					+ "                        <tr>\r\n"
					+ "                            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">MAC</th>\r\n"
					+ "                            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">"
					+ toMacAddress(mdVO.getMac()) + "</td>\r\n" + "                        </tr>\r\n"
					+ "                        <tr>\r\n"
					+ "                            <th style=\"width: 70px; padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">EPON MAC</th>\r\n"
					+ "                            <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">"
					+ toMacAddress(mdVO.getEpon_mac()) + "</td>\r\n" + "                        </tr>\r\n"
					+ "                    </table>\r\n" + "                </td>\r\n" + "            </tr>\r\n"
					+ "            <tr><th colspan=\"4\" style=\"border-top: 3px double #CCC\"></th></tr>";
		}
		html += "        <tr>\r\n" + "            <td colspan=\"4\" style=\"padding:0;\">\r\n"
				+ "                <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"width:100%\">\r\n"
				+ "                    <tr>\r\n"
				+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">투자확정<br>"
				+ list01.get(0).getDept_name() + "</th>\r\n"
				+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">IP & MAC확정<br>"
				+ list02.get(0).getDept_name() + "</th>\r\n"
				+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">MGID 확정<br>"
				+ list03.get(0).getDept_name() + "</th>\r\n"
				+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">착공(공사요청)<br>"
				+ list04.get(0).getDept_name() + "</th>\r\n"
				+ "                        <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">COLCODE확정<br>"
				+ list05.get(0).getDept_name() + "</th>\r\n" + "                    </tr>\r\n"
				+ "                    <tr>\r\n"
				+ "						<td style=\"vertical-align: top; padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">";
		for (UserInfoVO infoVO : list01) {
			if (infoVO.getChk().equals("1")) {
				html += "				<p style=\"margin:0; padding:0\">" + infoVO.getEmp_name()
						+ " <span style=\"font-size:8pt; letter-spacing: -1px;\">" + toTelNum(infoVO.getPhone_number())
						+ "</span></p>";
			}
		}
		html += "				</td>\r\n"
				+ "						<td style=\"vertical-align: top; padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">";
		for (UserInfoVO infoVO : list02) {
			if (infoVO.getChk().equals("1")) {
				html += "				<p style=\"margin:0; padding:0\">" + infoVO.getEmp_name()
						+ " <span style=\"font-size:8pt; letter-spacing: -1px;\">" + toTelNum(infoVO.getPhone_number())
						+ "</span></p>";
			}
		}
		html += "				</td>\r\n"
				+ "						<td style=\"vertical-align: top; padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">";
		for (UserInfoVO infoVO : list03) {
			if (infoVO.getChk().equals("1")) {
				html += "				<p style=\"margin:0; padding:0\">" + infoVO.getEmp_name()
						+ " <span style=\"font-size:8pt; letter-spacing: -1px;\">" + toTelNum(infoVO.getPhone_number())
						+ "</span></p>";
			}
		}
		html += "				</td>\r\n"
				+ "						<td style=\"vertical-align: top; padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">";
		for (UserInfoVO infoVO : list04) {
			if (infoVO.getChk().equals("1")) {
				html += "				<p style=\"margin:0; padding:0\">" + infoVO.getEmp_name()
						+ " <span style=\"font-size:8pt; letter-spacing: -1px;\">" + toTelNum(infoVO.getPhone_number())
						+ "</span></p>";
			}
		}
		html += "				</td>\r\n"
				+ "						<td style=\"vertical-align: top; padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; text-align: center;\">";
		for (UserInfoVO infoVO : list05) {
			if (infoVO.getChk().equals("1")) {
				html += "				<p style=\"margin:0; padding:0\">" + infoVO.getEmp_name()
						+ " <span style=\"font-size:8pt; letter-spacing: -1px;\">" + toTelNum(infoVO.getPhone_number())
						+ "</span></p>";
			}
		}
		html += "				</td>\r\n" + "                    </tr>\r\n" + "                </table>\r\n"
				+ "            </td>\r\n" + "        </tr>\r\n";
		if (!isNull(psList)) {
			for (ProcessVO psVO : psList) {
				html += "        <tr>\r\n"
						+ "            <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">"
						+ psVO.getStatus() + "</th>\r\n"
						+ "            <td colspan=\"3\" style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">\r\n"
						+ "                <div style=\"font-size: 8pt; margin-bottom: 5px;\"><b>" + psVO.getEmp_name()
						+ " (" + toTelNum(psVO.getPhone_number()) + ")</b> - " + psVO.getOffice_nm() + "</div>\r\n"
						+ "                <div>" + psVO.getContents() + "</div>\r\n" + "            </td>\r\n"
						+ "        </tr>\r\n";
			}
		}
		html += "    </table>\r\n" + "\r\n" + "    <div style=\"text-align:center; margin-top: 20px; \">\r\n"
				+ "        <a href=\"http://" + url + "/4p/request_view?rstNo=" + vo.getNeoss_no()
				+ "\" target=\"_blank\" ><span style=\"padding:10px 30px; -webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px; background-color: #5f115d; border: 1px solid  #5f115d; color: #FFFFFF; font-size: 12pt;\">바로가기</span></a>\r\n"
				+ "    </div>\r\n" + "    </div>\r\n" + "</div>";

		return html;
	}

	// 관리자 메일 발송
	public String getManagerEmail(EmailVO vo) {
		String html = "<div style=\"width: 630px; margin:0; padding: 0;\">\r\n"
				+ "<div style=\"padding: 10px 20px; font-family: 'malgunGothic'; font-size: 12pt; font-weight: bold; \">"
				+ "아래와 같이 공지 하오니 참고 바랍니다." + "</div>\r\n"
				+ "<div style=\" border: 1px dashed #666; padding-bottom: 20px; \">\r\n"
				+ "<div style=\"display:block; height: 55px; padding: 10px; \">\r\n"
				+ "<h3 style=\"float: left; margin: 0;\">\r\n"
				+ "<span style=\"font-size: 38pt; font-weight: bolder\">kt</span>&nbsp;\r\n"
				+ "<span style=\"font-family:Verdana; letter-spacing: -1.5px; font-size: 20pt; \"><strong style=\"color:#993399\">AGW</strong>-Ne</span>\r\n"
				+ "<h3 style=\"float: right; margin: 0; vertical-align: bottom; font-size:12pt; font-family:'Trebuchet MS', sans-serif; font-weight: bolder; letter-spacing: -2px; color: #666; \">관리자 공지 메일</h3>\r\n"
				+ "</div>\r\n"
				+ "<div style=\"clear:both; width:93.7%; background-color:#666; padding: 10px 20px; display: inline-block; margin-bottom: 0;\">\r\n"
				+ "<span style=\"font-size:9pt; width:100%; font-family:'Trebuchet MS', sans-serif; font-weight: bold; color: #ffffff; float: left;  \">"
				+ vo.getSubject() + "</span>\r\n" + "</div>\r\n"
				+ "<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"margin:0; padding:0; width:100%;\">\r\n"
				+ "<tr>\r\n"
				+ "<td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
				+ vo.getContent().replaceAll("\r\n", "<br/>") + "<br/><br/>" +"</td>\r\n" + "</tr>\r\n" + "</table>\r\n"
				+ "<div style=\"text-align:center; margin-top: 20px; \">\r\n"
				+ "<a href=\"http://neoss-ne.kt.co.kr\" target=\"_blank\"><span style=\"padding:10px 30px; -webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px; background-color: #5f115d; border: 1px solid  #5f115d; color: #FFFFFF; font-size: 12pt;\">바로가기</span></a>\r\n"
				+ "</div>\r\n" + "</div>\r\n" + "</div>";
		
		return html;
	}

	// 반려 되었음
	public String getEmailReject(BusinessVO bsVO) {
		String html = "반려되었음";

		return html;
	}

	// 게시판
	public String getEmailBBS(ReplyVO vo) {
		String location = "http://" + url + "/board/content?bbs_no=" + vo.getBbs_no() + "&bbs_gb=" + vo.getBbs_gb();

		String title = "";
		switch (vo.getBbs_gb()) {
		case "N":
			title = "공지사항";
			break;
		case "D":
			title = "자료실";
			break;
		case "Q":
			title = "Q&A";
			break;
		default:
			title = "게시판";
			break;
		}

		SimpleDateFormat sdf = new SimpleDateFormat("yyyy/MM/dd kk:mm");
		String input_dt = sdf.format(vo.getInput_dt());
		String contents = getText(vo.getContents());

		String html = "" + "<div style=\"width: 600px; margin:0; padding: 0;\">\r\n"
				+ "    <div style=\"padding: 10px 20px; font-family: 'malgunGothic'; font-size: 12pt; font-weight: bold; \">\r\n"
				+ "        등록하신 게시글에 댓글이 등록되었습니다.\r\n" + "    </div>\r\n"
				+ "    <div style=\" border: 1px dashed #666; padding-bottom: 20px; \">\r\n"
				+ "        <div style=\"display:block; height: 55px; padding: 10px; vertical-align: bottom;\">\r\n"
				+ "        <h3 style=\"float: left; margin: 0;\">\r\n"
				+ "            <span style=\"font-size: 38pt; font-weight: bolder\">kt</span>&nbsp;\r\n"
				+ "            <span style=\"font-family:Verdana; letter-spacing: -1.5px; font-size: 20pt; \"><strong style=\"color:#993399\">AGW</strong>-Ne</span>\r\n"
				+ "        </h3>\r\n"
				+ "            <h3 style=\"float: right; margin: 0; vertical-align: bottom; font-size:12pt; font-family:'Trebuchet MS', sans-serif; font-weight: bolder; letter-spacing: 1px; color: #666; margin-top: 30px;\">게시판 > "
				+ title + "</h3>\r\n" + "        </div>\r\n" + "\r\n"
				+ "        <div style=\"clear:both; background-color:#666; padding: 10px 20px;\">\r\n"
				+ "            <span style=\"font-size:9pt; font-family:'Trebuchet MS', sans-serif; color: #FFFFFF;\">"
				+ vo.getTitle() + "</span>\r\n" + "        </div>\r\n"
				+ "        <table width=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"margin:0; padding:0; width:100%; table-layout: fixed\">\r\n"
				+ "            <tr>\r\n"
				+ "                <th width=\"80\" style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">등록자</th>\r\n"
				+ "                <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
				+ vo.getInput_name() + "</td>\r\n"
				+ "                <th width=\"80\" style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">등록일</th>\r\n"
				+ "                <td style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
				+ input_dt + "</td>\r\n" + "            </tr>\r\n" + "            <tr>\r\n"
				+ "                <th style=\"padding: 5px 10px; background: #ECECEC; color: #666; font-weight: bold; text-align: center; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC; \">내용</th>\r\n"
				+ "                <td colspan=\"3\" style=\"padding: 5px 10px; font-size: 9pt; font-family:'Trebuchet MS', sans-serif; border-bottom: 1px solid #CCC;\">"
				+ contents + "</td>\r\n" + "            </tr>\r\n" + "        </table>\r\n" + "\r\n"
				+ "        <div style=\"text-align:center; margin-top: 20px; \">\r\n" + "            <a href=\""
				+ location
				+ "\" target=\"_blank\"><span style=\"padding:10px 30px; -webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px; background-color: #5f115d; border: 1px solid  #5f115d; color: #FFFFFF; font-size: 12pt;\">바로가기</span></a>\r\n"
				+ "        </div>\r\n" + "    </div>\r\n" + "</div>\r\n";

		return html;
	}
}
