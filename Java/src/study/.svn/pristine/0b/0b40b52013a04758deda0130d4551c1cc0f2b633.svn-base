<%@ page language="java" contentType="text/html; charset=EUC-KR" pageEncoding="EUC-KR"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %> 
<%@ taglib prefix="custom" uri="/tags/custom-taglib" %> 
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %> 
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<!DOCTYPE html>
<html lang="ko">
<head>
<%@ include file = "/resources/inc/meta.jsp" %>
<link rel="stylesheet" href="/resources/css/business.css">
<script type="text/javascript" src="/resources/js/business.js" charset="euc-kr" ></script>
</head>
<body>
<%@ include file = "/resources/inc/header_nav.jsp" %>
<%@ include file = "/resources/inc/aside.jsp" %>
<c:if test="${requestView.business_cd eq '01' }"> <c:set value="신/증설" var = "business_cd"/></c:if>
<c:if test="${requestView.business_cd eq '02' }"> <c:set value="돌발" var = "business_cd"/></c:if>
<section>
    <h1 class="list">AGW</h1>

    <div class="contents_form">
        <!-- 타이틀, 경로 -->
        <div class="divDocTitle">수요 공급 요청 </div>
        <!-- VIEW -->
        <div id="breadcrumb"><div class="line"></div>
			  <ul>
			    <li id="p_01" <c:if test="${requestView.status_cd eq '01' && !requestView.request_yn}"> class="active"</c:if>>투자확정요청중</li>
			    <li id="p_06" <c:if test="${requestView.status_cd eq '06' && !requestView.request_yn}"> class="active"</c:if>>착공요청중</li>
			    <li id="p_06" <c:if test="${requestView.status_cd eq '06' && requestView.request_yn}"> class="active"</c:if>>착공(공사요청)</li>
<%-- 			    <li id="p_02" <c:if test="${requestView.status_cd eq '02' && !requestView.request_yn}"> class="active"</c:if>>IP확정요청</li>
			    <li id="p_03" <c:if test="${requestView.status_cd eq '03' && !requestView.request_yn}"> class="active"</c:if>>MGID확정요청</li>
			    <li id="p_04" <c:if test="${requestView.status_cd eq '04' && !requestView.request_yn}"> class="active"</c:if>>COLCODE확정요청</li>
			    <li id="p_05" <c:if test="${requestView.status_cd eq '05' && !requestView.request_yn}"> class="active"</c:if>>장비정보등록요청</li>
			    <li id="p_06" <c:if test="${requestView.status_cd eq '06' && !requestView.request_yn}"> class="active"</c:if>>착공요청</li>
			    <li id="p_07" <c:if test="${requestView.status_cd eq '07' && !requestView.request_yn}"> class="active"</c:if>>준공요청</li>
			    <li id="p_07" <c:if test="${requestView.status_cd eq '07' && requestView.request_yn }"> class="active"</c:if>>준공</li>  --%>
			  </ul>
		</div>
		<div class="topBtnArea">
			<div class="btnArea">
				<c:if test="${authChk.a0_mail eq 'Y'}">
		      		<input type="image" class="button" id="rstBtn01" name="rstBtn01"  alt="재발송"  src="/resources/img/btn_resend.png"/>
		      	</c:if>
		      	<c:if test="${authChk.a0 eq 'Y'}">
		           <c:if test="${requestView.status_cd eq '99'}" >
		           		<form method="POST" name="reject_request_form" id="reject_request_form" action="process_write" target="pageRefreshing">
		           		<input type="hidden" name="neoss_no" id="neoss_no" value="${requestView.neoss_no}">
				        <input type="hidden" name="status_cd" id="status_cd" value="${requestView.status_cd}">
				        <input type="hidden" name="request_yn" id="request_yn" value="${requestView.request_yn}">
				        <input type="hidden" name="olt_user_id" id="olt_user_id" value="${modelInfo_view.olt_user_id}">
				        <input type="hidden" name="no_emp" id="no_emp" value="${confirmNo_emp.st_01}">
		           		</form>
		           		<input type="image" name="rstBtn01"  id="reject_request" src="/resources/img/btn_rst.gif" alt="반려된 건을 다시 요청" />
		           		<input type="image" src="/resources/img/btn_delete.gif" name="deleteBtn" id="deleteBtn_top" style="cursor:pointer" alt="삭제" />
		           	</c:if>
		           	<c:if test="${requestView.status_cd ne '99' && sessionScope.role eq '02' }">
	          			<input type="image" src="/resources/img/btn_delete.gif" name="deleteBtn" id="deleteBtn_top" style="cursor:pointer" alt="삭제" />
	          		</c:if>
		          	<a href="javascript:void(0);" onclick="popLink('request?neoss_no=${requestView.neoss_no}&flag=1&modFlag=1', 820, 900);"><img id="modifyRun" class="srchIcon" src="/resources/img/btn_modify.gif" alt="수정" /></a>
		          </c:if> 	
		      		<span style="cursor:pointer"><img src="/resources/img/btn_print.png" alt="인쇄" class="btnPrint" /></span>
		            <a href="list?${pageInfo.param }"><img class="srchIcon" src="/resources/img/btn_list.gif" alt="목록" /></a>
      		 </div>
        </div>
        <table class="viewTable" id="viewTable" border="0" cellspacing="0" cellpadding="0">
            <tbody>
            <tr>
                <th>요청번호</th>
                <td><b>${requestView.doc_no}</b></td>
                <th>공급요청자</th>
                <td>${requestView.emp_name} (${requestView.input_dt})</td>
            </tr>
            <tr>
                <th>조직</th>
                <td>${requestView.office_nm }</td>
                <th>입주예정일</th>
                <td>${requestView.move_dt }&nbsp;</td>
            </tr>
            <tr>
                <th>건물형태</th>
                <td>${requestView.build_nm} > ${requestView.buildshape_nm }  > ${requestView.section_nm } </td>
                <th>공급일</th>
                <td>${requestView.supply_dt }&nbsp;</td>
            </tr>
            <tr>
                <th>설치주소</th>
                <td colspan="3">(우:${requestView.post }) ${requestView.address1 }&nbsp;${requestView.address2 }</td>
            </tr>
          	</tbody>
        </table>

        <table class="viewTable" width="100%" border="0" cellspacing="0" cellpadding="0">
            <tbody>
            <tr>
                <th>공급구분</th>
                <td>${requestView.supply_cd }</td>
            </tr>
			<tr>
                <th>공급사유</th>
                <td>${requestView.reason_nm }&nbsp;[상세사유: ${requestView.reason }]</td>
            </tr>
        </table>
        <table class="viewTable" width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
				<th class="w30" rowspan="4" style="line-height:1.3em;">공<br>급<br>회<br>선</th>
       			<th>세대수</th>
       			<td >${requestView.household_no } 세대</td>
       			<th class="w30" rowspan="4" style="line-height:1.3em;">소<br>요<br>경<br>비<br>(원)</th>
       			<th>물자비</th>
       			<td ><span class="wonArea"><fmt:formatNumber value="${requestView.expense1}" pattern="#,###"/></span></td>
       		</tr>
       		<tr>
       			<th>시장점유율</th>
       			<td >${requestView.share_nm}</td>
       			<th>공사비</th>
       			<td ><span class="wonArea"><fmt:formatNumber value="${requestView.expense2}" pattern="#,###"/></span></td>
       		</tr>
       		<tr>
       			<th>공급회선</th>
       			<td >${requestView.model_num } 회선</td>
       			<th>경비</th>
       			<td ><span class="wonArea"><fmt:formatNumber value="${requestView.expense3}" pattern="#,###"/></span></td>
       		</tr>
       		<tr>
       			<th>공급내역</th>
       			<td >${requestView.model_nm }</td>
       			<th>계</th>
       			<td ><strong><span class="wonArea"><fmt:formatNumber value="${requestView.tot_expense}" pattern="#,###"/></span></strong></td>
       		</tr>
       	</table>
       	
        <c:if test="${not empty csVO}">
        <table class="viewTable" width="100%" border="0" cellspacing="0" cellpadding="0">
            <tbody>
            <tr>
            	<th class="w30" rowspan="6">착<br><br>공</th>
            	<th>착공일</th>
                <td >${csVO.st_dt }</td>                
            </tr>
            <c:if test="${not empty csmemVO }">
            <c:forEach var="csmemVO" items="${csmemVO }" varStatus="status">
            <c:if test="${csmemVO.mem_cd eq '01' }">
            <tr>
              <th>설계자</th>
               	<td>
               		<b>${csmemVO.emp_name}</b>(${csmemVO.phone_number }) -
               		<c:choose>
	               		<c:when test="${csmemVO.ex_biz_company_nm eq null}">
						 ${csmemVO.dept_name}
						</c:when>
						<c:otherwise>
							${csmemVO.ex_biz_company_nm}
						</c:otherwise>
				</c:choose>
               	</td>
            </tr>
            </c:if>
            <c:if test="${csmemVO.mem_cd eq '02' }">
            <tr>
            	<th>책임 감리자</th>
               	<td>
               		<b>${csmemVO.emp_name}</b>(${csmemVO.phone_number }) -
               		<c:choose>
	               		<c:when test="${csmemVO.ex_biz_company_nm eq null}">
							${csmemVO.dept_name}
						</c:when>
						<c:otherwise>
							${csmemVO.ex_biz_company_nm}
						</c:otherwise>
				</c:choose>
               	</td>
            </tr>
            </c:if>
            <c:if test="${csmemVO.mem_cd eq '03' }">
            <tr>
                <th>인수 시험자</th>
               	<td>
               		<b>${csmemVO.emp_name}</b>(${csmemVO.phone_number }) -
               		<c:choose>
	               		<c:when test="${csmemVO.ex_biz_company_nm eq null}">
							${csmemVO.dept_name}
						</c:when>
						<c:otherwise>
							${csmemVO.ex_biz_company_nm}
						</c:otherwise>
				</c:choose>
               	</td>
            </tr>
            </c:if>
            <c:if test="${csmemVO.mem_cd eq '04' }">
            <tr>    
            	<th>공사업체</th>
               	<td>
               		<b>${csmemVO.emp_name}</b>(${csmemVO.phone_number }) -
               		<c:choose>
	               		<c:when test="${csmemVO.ex_biz_company_nm eq null}">
							${csmemVO.dept_name}
						</c:when>
						<c:otherwise>
							${csmemVO.ex_biz_company_nm}
						</c:otherwise>
				</c:choose>
               	</td>
             </tr>
             </c:if>
             </c:forEach>
             </c:if>
            <tr>
             	<th>공사개요</th>
                <td>${csVO.const_st_desc }</td>
            </tr>
        </table>
<%--         <table class="viewTable" width="100%" border="0" cellspacing="0" cellpadding="0">
            <tr>
            	<th class="w30" rowspan="2">준<br>공</th>
                <th>준공일</th>
                <td>${csVO.ed_dt }</td>
            </tr>
            <tr>
            	<th>준공보고</th>
               	<td>${csVO.const_ed_desc }</td>
            </tr>
            </tbody>
        </table> --%>
        </c:if>
        <c:if test="${not empty attachList}">
		<h5>· 첨부파일</h5>
        <table class="viewTable" width="100%" border="0" cellspacing="0" cellpadding="0">
            <tbody>
            <tr>
                <th>문서</th>
                <td>
            		<ul id="attachList" >
						<c:forEach var="vo" items="${attachList }">
						<c:set var="filesize" value="${vo.filesize }" />
						<c:set var="KBfilesize" value="${filesize/1024 }" />
						<c:set var="MBfilesize" value="${KBfilesize/1024 }" />
						<fmt:formatNumber var="KBfilesize" value="${KBfilesize }" pattern="#.#" />
						<fmt:formatNumber var="MBfilesize" value="${MBfilesize }" pattern="#.#" />
						<c:set var="format" value="${fn:substring(vo.filename_n, fn:indexOf(vo.filename_n,'.')+1, fn:length(vo.filename_n)) }"/> <!-- 확장자 구분하기 -->
						<c:choose>
						<c:when test = "${format eq 'jpg' || format eq 'png' || foramt eq 'gif' || format eq 'bmp' || format eq 'JPG' || format eq 'PNG' || format eq 'GIF' || format eq 'BMP'}">
						</c:when>
						<c:otherwise>
						<li><a href="/fileDownload?no=${vo.attach_no }">${vo.filename }</a> <em>(${(filesize<1048576)? KBfilesize : MBfilesize }${(filesize<1048576)? 'K' : 'M' }B)</em></li>
						</c:otherwise>
						</c:choose>
						</c:forEach>
					</ul>
            	</td>
            </tr>
            <tr>
            <th>이미지</th>
    		<td>
            	<ul class="imageList">
						<c:forEach var="vo" items="${attachList }">
						<c:set var="filesize" value="${vo.filesize }" />
						<c:set var="KBfilesize" value="${filesize/1024 }" />
						<c:set var="MBfilesize" value="${KBfilesize/1024 }" />
						<fmt:formatNumber var="KBfilesize" value="${KBfilesize }" pattern="#.#" />
						<fmt:formatNumber var="MBfilesize" value="${MBfilesize }" pattern="#.#" />
						<c:set var="format" value="${fn:substring(vo.filename_n, fn:indexOf(vo.filename_n,'.')+1, fn:length(vo.filename_n)) }"/> <!-- 확장자 구분하기 -->
						<c:if test = "${format eq 'jpg' || format eq 'png' || foramt eq 'gif' || format eq 'bmp' || format eq 'JPG' || format eq 'PNG' || foramt eq 'GIF' || format eq 'BMP'}">
						<li><img id="img${vo.attach_no }" class="imgli" src="/resources/upload/${vo.filepath}${vo.filename_n}" />
						<p><a href="/fileDownload?no=${vo.attach_no }">${vo.filename }</a></p></li>
						</c:if>
						</c:forEach>
					</ul>
				</td>
            </tr>
            </tbody>
        </table>
        </c:if>
        <h5>· 승인자</h5>
       <table  class="viewTable" width="100%" border="0" cellspacing="0" cellpadding="0">
           <tbody>
		         	<tr>
		            	<th>투자확정</th>
<!-- 		            	<th>IP확정</th>
		            	<th>MGID확정</th>
		            	<th>COLCODE확정</th>
		            	<th>장비정보확정</th>-->
		            	<th>착공(공사요청)</th> 
		            	<!-- <th>준공</th> -->
		            </tr>
		            <tr>
		            <c:choose>
          			<c:when test ="${not empty confrimUsrList }">
          			<c:set var="loop_break" value="false"/>
		            <c:forEach var="list" items="${confrimUsrList }">
		            <c:if test="${list.status_cd eq '01' || list.status_cd eq '06'  }">
		            	<td class="center">${list.bonbu_name }<br>${list.org_name }<br><b>${list.emp_name }<br>(${list.phone_number })</b></td>
		            </c:if>
		            </c:forEach>
		            </c:when>
		            <c:otherwise>
		            	<td class="center" colspan='7'>결과없음</td>
		            </c:otherwise>
		            </c:choose>
		            </tr>
            </tbody>
        </table>
<%--         <div class="leftBtnArea">
        <c:if test="${next_no != 0 }">
            <a href="request_view?rstNo=${next_no }"><img class="srchIcon" src="/resources/img/btn_bbs_prev.gif" alt="다음" /></a>
        </c:if>
        <c:if test="${prev_no != 0 }">
            <a href="request_view?rstNo=${prev_no }"><img class="srchIcon" src="/resources/img/btn_bbs_next.gif" alt="이전" /></a>
        </c:if>   
        </div> --%>
        <div class="btnArea">
           <c:if test="${authChk.a0_mail eq 'Y'}">
      		<input type="image" class="button" id="rstBtn01" name="rstBtn01"  alt="재발송"  src="/resources/img/btn_resend.png"/>
      		</c:if>
      		<c:if test="${authChk.a0 eq 'Y'}">
	           <c:if test="${requestView.status_cd eq '99'}" >
	           		<form method="POST" name="reject_request_form" id="reject_request_form" action="process_write" target="pageRefreshing">
		           		<input type="hidden" name="neoss_no" id="neoss_no" value="${requestView.neoss_no}">
				        <input type="hidden" name="status_cd" id="status_cd" value="${requestView.status_cd}">
				        <input type="hidden" name="request_yn" id="request_yn" value="${requestView.request_yn}">
				        <input type="hidden" name="olt_user_id" id="olt_user_id" value="${modelInfo_view.olt_user_id}">
	           		</form>
	           		<input type="image" name="rstBtn01"  id="reject_request" src="/resources/img/btn_rst.gif" alt="반려된 건을 다시 요청" />
	           		<input type="image" src="/resources/img/btn_delete.gif"  name="deleteBtn" id="deleteBtn_bottom" style="cursor:pointer" alt="삭제" />
	           	</c:if>
	           	<c:if test="${requestView.status_cd ne '99' && sessionScope.role eq '02' }">
          			<input type="image" src="/resources/img/btn_delete.gif" name="deleteBtn" id="deleteBtn_top" style="cursor:pointer" alt="삭제" />
          		</c:if>
           		<a href="javascript:void(0);" onclick="popLink('request?neoss_no=${requestView.neoss_no}&flag=1&modFlag=1', 820, 900);"><img id="modifyRun" class="srchIcon" src="/resources/img/btn_modify.gif" alt="수정" /></a> 
           	</c:if>
            <span style="cursor:pointer"><img src="/resources/img/btn_print.png" alt="인쇄" class="btnPrint" /></span>
            <a href="list?${pageInfo.param }"><img class="srchIcon" src="/resources/img/btn_list.gif" alt="목록" /></a>
        </div>
        
        <div class="divDocTitle pt50">승인 및 반려</div>
        
        <div class="tabArea">
			<div id="tabs">
				<ul>
					<li id="tabs01"><a href="#tabs-1" >투자확정</a></li>
					<!-- <li id="tabs02"><a href="#tabs-2" >IP확정</a></li>
					<li id="tabs03"><a href="#tabs-3" >MGID확정</a></li>
					<li id="tabs04"><a href="#tabs-4" >COLCODE확정</a></li>
					<li id="tabs05"><a href="#tabs-5" >장비정보확정</a></li> -->
					<li id="tabs06"><a href="#tabs-6" >착공(공사요청)</a></li>
					<!-- <li id="tabs07"><a href="#tabs-7" >준공</a></li> -->
				</ul>
				
				<form method="POST" name="modelInfoForm" id="modelInfoForm" action="process_write" target="pageRefreshing">
				<input type="hidden" name="neoss_no" id="neoss_no" value="${requestView.neoss_no}">
				<input type="hidden" name="prev_status" id="prev_status" value="">
				<input type="hidden" name="status_cd" id="status_cd" value="${requestView.status_cd}">
				<input type="hidden" name="request_yn" id="request_yn" value="${requestView.request_yn}">
				<input type="hidden" name="status" id="status" value="${requestView.status_next}">
				<input type="hidden" name="olt_user_id" id="olt_user_id" value="${modelInfo_view.olt_user_id}">
				<%-- <input type="hidden" name="no_emp" id="no_emp" value="${confirmNo_emp.st_02}">	
				<input type="hidden" name="no_emp" id="no_emp" value="${confirmNo_emp.st_03}">	
				<input type="hidden" name="no_emp" id="no_emp" value="${confirmNo_emp.st_04}">	
				<input type="hidden" name="no_emp" id="no_emp" value="${confirmNo_emp.st_05}">	 --%><!-- [1차오픈] -->
				<!-- tabs-1 투자확정 -->
				<div id="tabs-1" >
					<table class="writeTable" border="0" cellspacing="0" cellpadding="0">
						<tbody>
						<tr>
							<th>의견 작성</th>
							<td>
								<textarea id="reply_write_contents_01" name= "reply_write_contents_01"  placeholder="의견 작성" >${pr_contents.contents_01 }</textarea>
								<input type="hidden" name="process_no_01" id="process_no_01" value="${pr_contents.process_no_01 }">
							</td>
						</tr>
						</tbody>
					</table>
						<div class="btnArea">
							<c:if test="${(requestView.status_cd eq '06' && !requestView.request_yn) && authChk.a1_mail eq 'Y' }">
								<button class="button" id="rstBtn01" name="rstBtn01" value="재발송">재발송</button>
							</c:if>
							<c:if test ="${ authChk.a1 eq 'Y' }">
								<c:if test="${requestView.status_cd eq '01' }">
								<button class="button" id="rstBtn01" name="rstBtn01" value="${requestView.status_next }">${requestView.status_next }</button>
								<c:if test="${requestView.status_cd ne '99'}">
								<button class="button" id="rejectBtn" name="rstBtn01" value="반려">반려</button></c:if>
								</c:if>
								<c:if test="${requestView.status_cd ne '01'}">
								<button class="button" id="rstBtn01" name="rstBtn01" value="수정">수정</button>
								</c:if>	
							</c:if>
						</div>
				</div>
				</form>
	         	
<%-- 	         	<!-- tabs-2 IP확정 -->
	         	<div id="tabs-2">
					<table class="writeTable" border="0" cellspacing="0" cellpadding="0">
						<tbody>
						<tr>
							<th>고정IP</th>
							<td>
								<input type="text" name="managed_ip" maxlength="15" id="managed_ip" value="${modelInfo_view.managed_ip}"/>
							</td>
							<th>SUBNET MASK</th>
							<td>
								<select name="subnetmask" id="subnetmask">
									<option value="24" <c:if test="${modelInfo_view.subnetmask == '24' }">selected="selected"</c:if>>24</option>
									<option value="25" <c:if test="${modelInfo_view.subnetmask == '25' }">selected="selected"</c:if>>25</option>
									<option value="26" <c:if test="${modelInfo_view.subnetmask == '26' }">selected="selected"</c:if>>26</option>
									<option value="27" <c:if test="${modelInfo_view.subnetmask == '27' }">selected="selected"</c:if>>27</option>
									<option value="28" <c:if test="${modelInfo_view.subnetmask == '28' }">selected="selected"</c:if>>28</option>
									<option value="29" <c:if test="${modelInfo_view.subnetmask == '29' }">selected="selected"</c:if>>29</option>
								</select>
							</td> 
							<th rowspan="2">검토의견</th>
							<td rowspan="2">
								<textarea id="reply_write_contents_02" name= "reply_write_contents_02" placeholder="의견 작성" >${pr_contents.contents_02 }</textarea>
								<input type="hidden" name="process_no_02" id="process_no_02" value="${pr_contents.process_no_02 }">		                        
							</td>
						</tr>
						<tr>
							<th>GATEWAY</th>
							<td>
								<input type="text" name="gw_ip" maxlength="15" id="gw_ip" value="${modelInfo_view.gw_ip }"/>
							</td>
							<th>MAC</th>
							<td>
								<input type="text" name="mac" maxlength="30" value="${modelInfo_view.mac }"/>
							</td>
						</tr>
						</tbody>
					</table>
					<c:if test ="${sessionScope.role eq '02' || confirmNo_emp.st_02 eq sessionScope.user_id || ( sessionScope.region eq confirmRegion.st_02 && sessionScope.approval_AGW.appr2 eq '1')}">
               	 	<div class="btnArea">
              	 	 <c:if test="${requestView.status_cd eq '02'}">
	               	 	 <button class="button" id="rstBtn02" name="rstBtn01" value="${requestView.status_next }">${requestView.status_next }</button>
	                     <c:if test="${requestView.status_cd ne '99'}"><button class="button" id="rejectBtn" name="rstBtn01" value="반려">반려</button></c:if>
                     </c:if>
                     <c:if test="${not empty modelInfo_view && requestView.status_cd ne '02'}">
	               	 	 <button class="button" id="rstBtn02" name="rstBtn01" value="수정">수정</button>
                     	<button class="button" id="rstBtn01" name="rstBtn01" value="재발송">재발송</button>
                     </c:if>
	            	</div>
	            	</c:if>
	            	
	         	</div>
	         	
	         	<!-- tabs-3 MGID확정 -->
	         	<div id="tabs-3" >	
					<table class="writeTable" width="100%" border="0" cellspacing="0" cellpadding="0">
		                   <tbody>
		                    <tr>
		                        <th>POTS명</th>
		                        <td>
		                        	<select style="width:180px;" name="pots_id" id="pots_id">
		                        	 <c:choose> 
	                    				<c:when test="${not empty md_list}"> 
	                        			<c:forEach var="pots_list" items="${md_list}" varStatus="status">  
				                        <option value="${pots_list.id }" <c:if test="${pots_list.id == modelInfo_view.pots_id }">selected="selected"</c:if>>${pots_list.nm}</option>
				                       </c:forEach>
				                       </c:when>
				                      </c:choose>
			                        </select>
		                        <th>MGID</th>
		                        <td><input type="number" min="1" max="9999" maxlength="4" name="mg_id" value="${modelInfo_view.mg_id}"/></td>
		                    </tr>
		                    <tr>
		                    	<th>START_LLN</th>
		                        <td><input type="number" min="1" max="9999999" maxlength="7"  name="start_lln" value="${modelInfo_view.start_lln }"/></td>  
		                        <th>AGW IP</th>
		                         <td>
			                        <input type="text" name="megaco_ip" id="megaco_ip" value="${modelInfo_view.megaco_ip}"/>
		                        </td>
		                    </tr>
		                    <tr>
		                     <th>IPSec-서버 IP</th>
		                         <td>
		                        	<select style="width:180px;" name="ipsec_ip" id="ipsec_ip">
		                        	 <c:choose> 
	                    				<c:when test="${not empty md_list2}"> 
	                        			<c:forEach var="ipsec_list" items="${md_list2}" varStatus="status">  
				                        <option value="${ipsec_list.id }" <c:if test="${ipsec_list.id == modelInfo_view.ipsec_ip }">selected="selected"</c:if>>${ipsec_list.ip}</option>
				                       </c:forEach>
				                       </c:when>
				                      </c:choose>
		                        	</select>
		                        </td>
		                        <th>EMS IP</th>
		                         <td>
		                        	<select style="width:180px;" name="ems_ip" id="ems_ip">
		                        	 <c:choose> 
	                    				<c:when test="${not empty md_list3}"> 
	                        			<c:forEach var="emsIp_list" items="${md_list3}" varStatus="status">  
				                        <option value="${emsIp_list.id }" <c:if test="${emsIp_list.id == modelInfo_view.ipsec_ip }">selected="selected"</c:if>>${emsIp_list.ktis_ip}</option>
				                       </c:forEach>
				                       </c:when>
				                      </c:choose>
			                        </select>
		                        </td>
		                    </tr>
		                   	<tr>
							<th>검토의견</th>
							<td colspan="5">
								<textarea style="height:50px;" id="reply_write_contents_03" name= "reply_write_contents_03" placeholder="의견 작성" >${pr_contents.contents_03 }</textarea>
								<input type="hidden" name="process_no_03" id="process_no_03" value="${pr_contents.process_no_03 }">	
							</td>
							</tr>
		                    </tbody>
	               	 	</table>
	               	 	<c:if test ="${sessionScope.role eq '02' ||  confirmNo_emp.st_03 eq sessionScope.user_id || ( sessionScope.region eq confirmRegion.st_03 && sessionScope.approval_AGW.appr3 eq '1')}">
	               	 	<div class="btnArea">
	              	 	 <c:if test="${requestView.status_cd eq '03'}">
		               	 	 <button class="button" id="rstBtn03" name="rstBtn01" value="${requestView.status_next }">${requestView.status_next }</button>
		                     <c:if test="${requestView.status_cd ne '99'}"><button class="button" id="rejectBtn" name="rstBtn01" value="반려">반려</button></c:if>
	                     </c:if>
	                     <c:if test="${not empty modelInfo_view && requestView.status_cd ne '03'}">
		               	 	 <button class="button" id="rstBtn03" name="rstBtn01" value="수정">수정</button>
	                    <button class="button" id="rstBtn01" name="rstBtn01" value="재발송">재발송</button>
	                     </c:if>
		            	</div>
		            	</c:if>
	            </div>
	            
	            <!-- tabs-4 COLCODE 확정 -->
	         	<div id="tabs-4" >
					<table class="writeTable" width="100%" border="0" cellspacing="0" cellpadding="0">
		                   <tbody>
		                    <tr>
		                        <th>COLCODE 입력</th>
		                        <td><input type="text" name="colcode" maxlength="9" value="${modelInfo_view.colcode }"/>
								<!-- <button id="button" onclick="" ><span class="ui-icon ui-icon-search"></span>검색</button> --></td>
		                        <th rowspan="3">검토의견</th>
		                        <td rowspan="3"><textarea id="reply_write_contents_04" name= "reply_write_contents_04"  placeholder="의견 작성" >${pr_contents.contents_04 }</textarea>
		                        <input type="hidden" name="process_no_04" id="process_no_04" value="${pr_contents.process_no_04 }">	
		                        </td>
		                    </tr>
		                    </tbody>
	               	 	</table>
	               	 	<c:if test ="${sessionScope.role eq '02' || confirmNo_emp.st_04 eq sessionScope.user_id || ( sessionScope.region eq confirmRegion.st_04 && sessionScope.approval_AGW.appr4 eq '1') }">
	               	 	<div class="btnArea">
	              	 	 <c:if test="${requestView.status_cd eq '04'}">
		               	 	 <button class="button" id="rstBtn04" name="rstBtn01" value="${requestView.status_next }">${requestView.status_next }</button>
		                     <c:if test="${requestView.status_cd ne '99'}"><button class="button" id="rejectBtn" name="rstBtn01" value="반려">반려</button></c:if>
	                     </c:if>
	                     <c:if test="${not empty modelInfo_view && requestView.status_cd ne '04'}">
		               	 	 <button class="button" id="rstBtn04" name="rstBtn01" value="수정">수정</button>
							<button class="button" id="rstBtn01" name="rstBtn01" value="재발송">재발송</button>
	                     </c:if>
		            	</div>
		            	</c:if>
	         	</div>
	         	
	         	<!-- tabs-5 장비정보등록 -->
	         	<div id="tabs-5" >
		                 <table class="writeTable"  width="100%" border="0" cellspacing="0" cellpadding="0">
		                   <tbody>
		                    <tr>
		                        <th>장비정보입력</th>
		                        <td><input type="text" maxlength="" name="modelmodel" value=""/></td>
		                        <th rowspan="3">검토의견</th>
		                        <td rowspan="3"><textarea id="reply_write_contents_05" name= "reply_write_contents_05"  placeholder="의견 작성" >${pr_contents.contents_05 }</textarea>
		                        <input type="hidden" name="process_no_05" id="process_no_05" value="${pr_contents.process_no_05 }">	
		                        </td>
		                    </tr>
		                    </tbody>
	               	 	</table>
	               	 	<c:if test ="${sessionScope.role eq '02' || confirmNo_emp.st_05 eq sessionScope.user_id || ( sessionScope.region eq confirmRegion.st_05 && sessionScope.approval_AGW.appr5 eq '1') }">
		                 <div class="btnArea">
	              	 	 <c:if test="${requestView.status_cd eq '05'}">
		               	 	 <button class="button" id="rstBtn05" name="rstBtn01" value="${requestView.status_next }">${requestView.status_next }</button>
		                     <c:if test="${requestView.status_cd ne '99'}"><button class="button" id="rejectBtn" name="rstBtn01" value="반려">반려</button></c:if>
	                     </c:if>
	                     <c:if test="${not empty modelInfo_view && requestView.status_cd ne '05'}">
		               	 	 <button class="button" id="rstBtn05" name="rstBtn01" value="수정">수정</button>
							<button class="button" id="rstBtn01" name="rstBtn01" value="재발송">재발송</button>
	                     </c:if>
		            	</div>
		            	</c:if>
	         		</div>
	         		
	         	</form>	
 --%>	         	
	         	<form method="POST" name="constructForm" id="constructForm" action="construct_write" target="pageRefreshing">
	         		<input type="hidden" name="neoss_no" value="${requestView.neoss_no}"/>   
		            <input type="hidden" name="const_no"  id="const_no" value="${csVO.const_no}"/>
		            <input type="hidden" name="gubun" id="gubun" value="01"/>
		            <input type="hidden" name="cnstType" id="cnstType" value="${requestView.status_cd}"/>  
		            <input type="hidden" name="contents" id="contents" value=""/>  
		            <input type="hidden" name="request_yn" id="request_yn" value="${requestView.request_yn}">
		            <input type="hidden" name="status_cd" id="status_cd" value="${requestView.status_cd}">
		            <input type="hidden" name="input_id" id="input_id" value="${csVO.input_id}">
		            <%-- <input type="hidden" name="no_emp" id="no_emp" value="${confirmNo_emp.st_06}">	[1차오픈] 
					<input type="hidden" name="no_emp" id="no_emp" value="${confirmNo_emp.st_07}">	--%>
		            <!-- tabs-6 공사정보 -->
	         		<div id="tabs-6" >
			             <div  id="cnstStDiv" >
			              <input type="hidden" name="process_no_06" id="process_no_06" value="${pr_contents.process_no_06}">
						<table class="writeTable" style="margin:0; border-top-width:1px; "  width="100%" border="0" cellspacing="0" cellpadding="0">
							<tbody>
							<tr>
								<th>착공일</th>
								<td>
									<fmt:parseDate var="parsedDate" value="${csVO.st_dt}" pattern="yyyy-MM-dd"/>
									<fmt:formatDate var="newFormattedDateString" value="${parsedDate}" pattern="yyyy-MM-dd"/> 
									<input type="text" class="datepicker" name="st_dt" id="st_dt" readonly="readonly" value="${newFormattedDateString }" />
								</td>
							</tr>
							<tr>
							<th>설계자</th>
								<td>
								<c:choose>
								<c:when test="${not empty csmemVO }">
								<c:set var ="breakloop" value="false"/>
								<c:forEach var="csmemVO" items="${csmemVO}" varStatus="status">
								<c:if test="${csmemVO.mem_cd eq '01' }">
									<span id="mem_01_name"><b>${csmemVO.emp_name}</b> (${csmemVO.phone_number }) - </span>
									<span id="mem_01_depart">
									<c:choose>
									<c:when test="${csmemVO.ex_biz_company_nm eq null}">
										${csmemVO.dept_name}
									</c:when>
									<c:otherwise>
										${csmemVO.ex_biz_company_nm}
									</c:otherwise>
									</c:choose>
									</span>									
									<input type="hidden" maxlength="20" class="inName" name="const_mem_no_01" id="const_mem_no_01" value="${csmemVO.const_mem_no }" readonly="readonly"/> 
									<input type="hidden" maxlength="20" class="inName" name="mem_01_id" id="mem_01_id" value="${csmemVO.user_no }" readonly="readonly"/> 
									<c:set var ="breakloop" value="true"/>
								</c:if>
								</c:forEach>
								<c:if test="${!breakloop }">
									<span id="mem_01_depart"></span>
									<span id="mem_01_name"></span>
									<input type="hidden" class="inName"  name="mem_01_id" id="mem_01_id" />
								</c:if>
								</c:when>
								<c:otherwise>
									<span id="mem_01_depart"></span>
									<span id="mem_01_name"></span>
									<input type="hidden" class="inName"  name="mem_01_id" id="mem_01_id" />
								</c:otherwise>
								</c:choose>
									<button name="usrSearchBtn" id="b_01" ><span class="ui-icon ui-icon-search"></span></button>
								</td>
								</tr>
							<tr>
								<th>책임 감리자</th>
								<td>
								<c:choose>
								<c:when test="${not empty csmemVO }">
								<c:set var ="breakloop" value="false"/>
								<c:forEach var="csmemVO" items="${csmemVO}" varStatus="status">
								<c:if test="${csmemVO.mem_cd eq '02' }">
									<span id="mem_02_name"><b>${csmemVO.emp_name} </b>(${csmemVO.phone_number }) -</span>
									<span id="mem_02_depart">
										<c:choose>
										<c:when test="${csmemVO.ex_biz_company_nm eq null}">
											${csmemVO.dept_name}
										</c:when>
										<c:otherwise>
											${csmemVO.ex_biz_company_nm}
										</c:otherwise>
										</c:choose>
									</span>
									<input type="hidden" maxlength="20" class="inName" name="const_mem_no_02" id="const_mem_no_02" value="${csmemVO.const_mem_no }" readonly="readonly"/>
									<input type="hidden" maxlength="20" class="inName" name="mem_02_id" id="mem_02_id" value="${csmemVO.user_no }" readonly="readonly"/> 
									<c:set var ="breakloop" value="true"/>
								</c:if>
								</c:forEach>
								<c:if test="${!breakloop }">
									<span id="mem_02_depart"></span>
									<span id="mem_02_name"></span>
									<input type="hidden" class="inName"  name="mem_02_id" id="mem_02_id" />
								</c:if>
								</c:when>
								<c:otherwise>
									<span id="mem_02_depart"></span>
									<span id="mem_02_name"></span>
									<input type="hidden" class="inName"  name="mem_02_id" id="mem_02_id" />
									</c:otherwise>
								</c:choose>
									<button name="usrSearchBtn" id="b_02" ><span class="ui-icon ui-icon-search"></span></button>
								</td>
								</tr>
							<tr>
								<th>인수 시험자</th>
								<td>
								<c:choose>
								<c:when test="${not empty csmemVO }">
								<c:set var ="breakloop" value="false"/>
								<c:forEach var="csmemVO" items="${csmemVO}" varStatus="status">
								<c:if test="${csmemVO.mem_cd eq '03' }">
								<span id="mem_03_name"><b>${csmemVO.emp_name}</b> (${csmemVO.phone_number }) - </span>
									<span id="mem_03_depart">
										<c:choose>
										<c:when test="${csmemVO.ex_biz_company_nm eq null}">
											${csmemVO.dept_name}
										</c:when>
										<c:otherwise>
											${csmemVO.ex_biz_company_nm}
										</c:otherwise>
										</c:choose>
									</span>
									<input type="hidden" maxlength="20" class="inName" name="const_mem_no_03" id="const_mem_no_03" value="${csmemVO.const_mem_no }" readonly="readonly"/>
									<input type="hidden" maxlength="20" class="inName" name="mem_03_id" id="mem_03_id" value="${csmemVO.user_no }" readonly="readonly"/> 
								<c:set var ="breakloop" value="true"/>
								</c:if>
								</c:forEach>
								<c:if test="${!breakloop }">
									<span id="mem_03_depart"></span>
									<span id="mem_03_name"></span>
									<input type="hidden" class="inName"  name="mem_03_id" id="mem_03_id" />
								</c:if>
								</c:when>
								<c:otherwise>
									<span id="mem_03_depart"></span>
									<span id="mem_03_name"></span>
									<input type="hidden" class="inName"  name="mem_03_id" id="mem_03_id" />
								</c:otherwise>
								</c:choose>
									<button name="usrSearchBtn" id="b_03" ><span class="ui-icon ui-icon-search"></span></button>
								</td>
							</tr>
								<tr>
								<th>공사업체</th>
								<td>	
								<c:choose>	
								<c:when test="${not empty csmemVO }">
								<c:set var ="breakloop" value="false"/>
								<c:forEach var="csmemVO" items="${csmemVO}" varStatus="status">
								<c:if test="${csmemVO.mem_cd eq '04' }">		
									<span id="mem_04_name"><b>${csmemVO.emp_name}</b> (${csmemVO.phone_number }) -</span>					
									<span id="mem_04_depart">
										<c:choose>
										<c:when test="${csmemVO.ex_biz_company_nm eq null}">
											${csmemVO.dept_name}
										</c:when>
										<c:otherwise>
											${csmemVO.ex_biz_company_nm}
										</c:otherwise>
										</c:choose>
									</span>
									<input type="hidden" maxlength="20" class="inName" name="const_mem_no_04" id="const_mem_no_04" value="${csmemVO.const_mem_no }" readonly="readonly"/>
									<input type="hidden" maxlength="20" class="inName" name="mem_04_id" id="mem_04_id" value="${csmemVO.no_emp }" readonly="readonly"/> 
								<c:set var ="breakloop" value="true"/>
								</c:if>
								</c:forEach>
								<c:if test="${!breakloop }">
									<span id="mem_04_depart"></span>
									<span id="mem_04_name"></span>
									<input type="hidden" class="inName"  name="mem_04_id" id="mem_04_id" />
								</c:if>
								</c:when>	
								<c:otherwise>
									<span id="mem_04_depart"></span>
									<span id="mem_04_name"></span>
									<input type="hidden" class="inName"  name="mem_04_id" id="mem_04_id" />
									</c:otherwise>
								</c:choose>
									<button name="usrSearchBtn" id="b_04" ><span class="ui-icon ui-icon-search"></span></button>
								</td>                        
							</tr>							
							<tr>
								<th>공사개요<br>(검토의견)</th>
								<td ><textarea name="const_st_desc" id="const_st_desc">${csVO.const_st_desc}</textarea></td>							
							</tr>
							</tbody>
						</table>
						<c:if test ="${authChk.a6 eq 'Y'}">
						<div class="btnArea">
	              	 	 <c:if test="${requestView.status_cd eq '06' && !requestView.request_yn}">
		               	 	 <button class="button" id="constBtn" name="constBtn" value="${requestView.status_next }">${requestView.status_next }</button>
	                     </c:if>
	                   <%--   <c:if test="${not empty modelInfo_view && requestView.status_cd ne '06' && requestView.request_yn}"> [1오픈]--%>
	                   <c:if test="${requestView.status_cd eq '06' && requestView.request_yn}">
		               	 	 <button class="button" id="constBtn" name="constBtn" value="수정">수정</button>
							<button class="button" id="constBtn" name="constBtn" value="재발송">재발송</button>
	                     </c:if>
			            </div>
			            </c:if>
	                </div>
                </div>
                </form>
                <!-- tabs-7 준공정보 -->
                <%-- <div id="tabs-7" >
	                 <div id="cnstEdDiv">
	                 <input type="hidden" name="process_no_07" id="process_no_07" value="${pr_contents.process_no_07}">
						<table class="writeTable" width="50%" border="0" cellspacing="0" cellpadding="0">
							<tbody>
							<tr>
								<th class="w30" rowspan="4">소<br>요<br>경<br>비</th>
								<th>물자비</th>
								<td>&#8361;&nbsp;
									<fmt:formatNumber var="expense1" value="${csVO.expense1}" pattern="#,###"/>
									<input type="text" maxlength="10" name="expense1" id="expense1" value="${expense1 }" />
								</td>
								<th>준공일</th>
								<td>
									<fmt:parseDate var="parsedDate" value="${csVO.ed_dt}" pattern="yyyy-MM-dd"/>
									<fmt:formatDate var="newFormattedDateString" value="${parsedDate}" pattern="yyyy-MM-dd"/> 
									<input type="text" class="datepicker" name="ed_dt" id="ed_dt" value="${newFormattedDateString }" readonly="readonly"/>
								</td>
							</tr>
							<tr>
								<th >공사비</th>
								<td>&#8361;&nbsp;
									<fmt:formatNumber var="expense2" value="${csVO.expense2}" pattern="#,###"/>
									<input type="text" maxlength="10" name="expense2" id="expense2" value="${expense2 }" />
								</td>
								<th rowspan="3">준공보고<br>(검토의견)</th>
								<td rowspan="3"><textarea name="const_ed_desc" id="const_ed_desc">${csVO.const_ed_desc}</textarea></td>
							</tr>
							<tr>
								<th>경비</th>
								<td>&#8361;&nbsp;
									<fmt:formatNumber var="expense3" value="${csVO.expense3}" pattern="#,###"/>
									<input type="text" maxlength="10" name="expense3" id="expense3" value="${expense3 }" />
								</td>
							</tr>
							<tr>
								<th>계</th>
								<td>&#8361;&nbsp;
									<fmt:formatNumber var="tot_expense" value="${csVO.tot_expense}" pattern="#,###"/>
									<input type="text" maxlength="10" name="tot_expense" id="tot_expense" value="${tot_expense }" />
								</td>
							</tr>
							</tbody>
						</table>
	                </div>
	                <c:if test ="${sessionScope.role eq '02' || confirmNo_emp.st_07 eq sessionScope.user_id || ( sessionScope.region eq confirmRegion.st_07 && sessionScope.approval_AGW.appr7 eq '1')}">
	                <div class="btnArea">
					<c:if test="${requestView.status_cd eq '07' && !requestView.request_yn}">
						<button class="button" id="constBtn" name="constBtn" value="${requestView.status_next }">${requestView.status_next }</button>
					</c:if>
					<c:if test="${not empty modelInfo_view && requestView.status_cd eq '07' && requestView.request_yn}">
						<button class="button" id="constBtn" name="constBtn" value="수정">수정</button>
						<button class="button" id="rstBtn01" name="rstBtn01" value="재발송">재발송</button>
					</c:if>
		            </div>
		            </c:if>
                </div>  --%>
              <!--   </form>  -->
			</div>		
		</div>

		<table class="listTable"  border="0" cellspacing="0" cellpadding="0">
			<thead>
			<tr> 
				<th width="40">No</th>
				<th width="100">날짜</th>
				<th width="100">승인상태</th>
				<th width="150">부서</th>
				<th width="80">승인자</th>
				<th width="100">연락처</th>
				<th>검토 의견</th>
			</tr>
			</thead>
			<tbody>
			<c:forEach var="processView" items="${processView}" varStatus="status">
			<!-- class="disabled" -->
			<tr <c:if test="${!processView.current_yn}"> class="disabled"</c:if>>
				<td>${processView.rnum }</td>
				<td>
					<fmt:parseDate var="parseDate" value="${processView.input_dt }" pattern="yyyy-MM-dd HH:mm:ss"/>
					<fmt:formatDate var="input_dt" value="${parseDate }" pattern="yy/MM/dd kk:mm" />
					${input_dt}
				</td>
				<td><b>${processView.status}</b></td>
				<td>${processView.branch_nm}</td>
				<td>${processView.emp_name}</td>
				<td>${processView.phone_number }</td>
				<td><div style="padding:0 10px 0 10px;">
					<% pageContext.setAttribute("newLineChar", "\n"); %>
					${fn:replace(processView.contents, newLineChar, '<br>')}</div></td>
			</tr>
			</c:forEach>
			</tbody>
		</table>  
	<c:if test="${not empty requestViewHistory }">
		<div class="divDocTitle" style="padding-top:50px; cursor:pointer" id="neoss_history_area"><span id ="history_btn">이력보기 ▼</span></div>
	        <div  id="history_list" style="display:none;">
				<table class="listTable" style="margin-top:15px;" border="0" cellspacing="0" cellpadding="0">
					<thead>
					<tr>
		                <th width="100">순번</th>
		                <th width="150">최종등록일</th>
		                <th width="100">최종등록자</th>
		                <th width="110">연락처</th>
		                <th>부서</th>
			        </tr>
					</thead>
					<tbody>
					  <c:forEach var="requestViewHist" items="${requestViewHistory}" varStatus="status"> 
						<tr style="cursor:pointer" onclick="open_pop('${requestViewHist.neoss_no}','${requestViewHist.history_no}', this);">
							<td>${requestViewHist.rnum}</td>
							<td>${requestViewHist.time_stamp}</td>
							<td>${requestViewHist.update_id }</td>
							<td>${requestViewHist.phone_number }</td>
							<td class="left">${requestViewHist.office_nm }</td> 
						</tr>
					  </c:forEach>
					</tbody>
				</table>   
			</div>
		</c:if>
    	<!-- 직원검색 -->
	    <div id="mask"></div>
	    <div class="window">
	    	<jsp:include page="../include/pop_usrSearch.jsp" flush="false"></jsp:include>
	    </div>			      
    <!-- ui-dialog창 오픈 -->
	<div id="dialog_request_view" title="수요공급요청" >
	</div>
	<div id="dialog_del" title="삭제" >
	<p></p>	</div>
	<div id="alert" title="알림창">
		<p>의견을 입력해야 합니다.</p>
	</div>
	<div id="dialog_construct" title="" >
	</div>
	</div>
</section>
<iframe name="pageRefreshing" src="" frameborder="0" width="0" height="0"></iframe>
<%@ include file = "/resources/inc/footer.jsp" %>
<script>
	if('${msg}' == "OK"){
		//alert('${msg}');
		location.href="list";
	}
	
	//tab id 초기 설정
	var idx = '${requestView.status_cd}';
	idx = 	idx.replace(/0/g,'');
	
	if('${requestView.status_cd}' != null || '${requestView.status_cd}' != '' ){
		
		if('${requestView.status_cd}' == '99'){
			//breadCrumble 셋팅
			var arg = "p_"+'${requestView.prev_status}';
			$("#"+arg).before('<li class="active" id="p_99">반려</li>');
			//승인반려 탭 셋팅
			$("#tabs").hide();
		}else{
			
			$("#tabs").show();
		}
		
		//[1차오픈] 두단계오픈위해서임시코드작성 이후에 하단 코드 주석해제후 사용
/* 		if( '${requestView.status_cd}' != '99' || '${requestView.status_cd}' != '01'){

			$(".selector").tabs();
			    var tabs = $("#tabs").tabs();
			    tabs.tabs({active:idx-1});
			    for (var i = idx; i < 8; i++) {
			    	$("#tabs0"+i).css({'pointer-events':'none'}); 
				}
			    $("#tabs0"+idx).css({'pointer-events':'auto'});
		} */
		//임시코드작성
		if('${requestView.status_cd}' == '01'){
			$(".selector").tabs();
		    var tabs = $("#tabs").tabs();
		    tabs.tabs({active:idx-1});
		    $("#tabs06").css({'pointer-events':'none'}); 
		    $("#tabs01").css({'pointer-events':'auto'});
	}else if('${requestView.status_cd}' == '06'){
			$(".selector").tabs();
		    var tabs = $("#tabs").tabs();
		    tabs.tabs({active:1});
		    $("#tabs06").css({'pointer-events':'auto'}); 
		    $("#tabs01").css({'pointer-events':'auto'});
	} 
		
		
	}
	
	$('#history_btn').click(function(){
		if($('#history_list').css("display") == "none"){
			$('#history_list').show();
		}else{
			$('#history_list').hide();
		}
	});
	
	$("button[name=cnstBtn]").click(function(){
			var cnstType = $(this).val();
			popLink('construct?cnstType='+cnstType+'&neoss_no=${requestView.neoss_no}', 500, 500);
		
	});
			

	function open_pop(data1,data2, obj){
			popLink('history_view?neoss_no='+data1+'&history_no='+data2, 810, 750);
	}
	
	
	$(document).ready(function(){
		
		$("input[name=deleteBtn]").click(function(){
			$("#dialog_del").find('p').remove();
			$("#dialog_del").append('<p>삭제하실 경우 현재 공급요청에 대한 전체 내용이 삭제됩니다.</p>');
			$("#dialog_del").append('<p>그래도 삭제 하시겠습니까?</p>');
			$("#dialog_del").dialog("option","title","수요공급요청 삭제"); //타이틀창 제목 옵션주는 법
			
			$( "#dialog_del" ).dialog( "open" );
			event.preventDefault();
		});
		$( "#dialog_del" ).dialog({
	    	autoOpen: false,
	    	width: 400,
	    	buttons: [
	    		{
	    			text: "예",
	    			click: function() {
						location.href="del_request?neoss_no="+'${requestView.neoss_no}'+"&page=redirect:list";
	    			    
	    			}
	    		},
	    		{
	    			text: "취소",
	    			click: function() {
	    				$( this ).dialog( "close" );
	    				
	    			}
	    		}
	    	]
	    });
		
		$("button[name=constBtn]").click(function(){
			var title = "착공현황";
			var sub_title = $(this).val();//$("#tabs-6 #constBtn").val();
			$("#dialog_construct").attr('name','s_construct');
			
			var i = parseInt($("#tabs").tabs('option','active')+1);	//현재 선택된 탭의 인덱스 알아내기
			
			if(i==6 && sub_title == '수정'){
				
			}else if(i==7 && '${requestView.status_cd}'=="07"){
				title = "준공현황";
				sub_title = $("#tabs-7 #constBtn").val();
				$("#dialog_construct").attr('name','e_construct');
			}		
			$("#dialog_construct").attr('class', $(this).val()); //알림창구분자 추가
			$("#dialog_construct").find('p').remove();
			$("#dialog_construct").append('<p>'+sub_title+'하시겠습니까?</p>');
			$("#dialog_construct").dialog("option","title",title); //타이틀창 제목 옵션주는 법
			$("#dialog_construct" ).dialog( "open" );
			event.preventDefault();
		
	});
		
	//검토의견등록시
	    $("button[name=rstBtn01]").click(function(){
	    	var idChk = $(this).attr('id');
	    	var i = parseInt($("#tabs").tabs('option','active')+1);
	    	if(idChk =='rejectBtn'|| idChk=='rstBtn0'+i){ //요청,반려
	    			if($("#reply_write_contents_0"+i).val()==''||$("#reply_write_contents_0"+i).val==null){
	    				$( "#alert" ).dialog( "open" );
	    				event.preventDefault();
	    				return;
	    		}
	    	}
	    	$("#dialog_request_view").find('p').remove();
	    	$("#dialog_request_view").append('<p>&nbsp;&nbsp;'+$(this).val()+' 하시겠습니까?</p>');   
	    	$("#dialog_request_view").attr('class', $(this).attr('id')); //알림창구분자 추가
	    	$("#dialog_request_view").attr('name', $(this).val()); //알림창구분자 추가
	    	
			$( "#dialog_request_view" ).dialog( "open" );
			event.preventDefault();
		    	
	    });
	
	    $("input[name=rstBtn01]").click(function(){
	    	$("#dialog_request_view").find('p').remove();
	    	$("#dialog_request_view").append('<p>&nbsp;&nbsp;'+$(this).attr('alt')+' 하시겠습니까?</p>');   
	    	$("#dialog_request_view").attr('class', $(this).attr('id')); //알림창구분자 추가
	    	$("#dialog_request_view").attr('name', $(this).attr('alt')); //알림창구분자 추가
	    	
	    	
			$( "#dialog_request_view" ).dialog( "open" );
			event.preventDefault();
	    });
	    
		//확정등록
	  $( "#dialog_request_view" ).dialog({
	    	autoOpen: false,
	    	width: 400,
	    	buttons: [
	    		{
	    			text: "예",
	    			click: function() {
	    				$( this ).dialog( "close" );
	    				 $.blockUI();
	    				var Chkval = $(this).attr('class');
	    				var i = parseInt($("#tabs").tabs('option','active')+1);	//현재 선택된 탭의 인덱스 알아내기
	    				var formId = "modelInfoForm";
	    				
	    				if('${requestView.status_cd}'=='99'){//현재상태가 반려인경우 1차 검토요청으로 가기 위한 데이터 셋팅
	    	        		if(Chkval=='reject_request'){
	    	        			formId="reject_request_form";
	    	        			$("#constructForm").remove();
	    	        			$("#modelInfoForm").remove();
	    	        		}
	    	        		$("#status_cd").attr('value','00');
	    	        		$("#request_yn").attr('value','false');
	    	        		
	    	        		//alert($("#status_cd").val());
	    	        		//alert($("#request_yn").val());
	    	        		
	    	        		$("#"+formId).submit();
	    	        		return;
	    	        		
	    	        	} 
	    				
	    					    				
	    		    	if($(this).attr('name')=='수정'){
	    		    		$("#modelInfoForm").attr('action','process_modi');		//action주소 변경
	    		    		$("#reply_write_contents_0"+i).attr('name','contents');
	    		    		$('#process_no_0'+i).attr('name','process_no'); //인덱스에 해당하는 정보 입력하기
	    		    	
	    		    	}else if($(this).attr('name')=='재발송'){
							$("#modelInfoForm").attr('action','reWriteMail');		//action주소 변경
							if('${requestView.status_cd}'== '01' && '${requestView.request_yn}' == 'false'){
							}else{
								$('#process_no_0'+i).attr('name','process_no'); //인덱스에 해당하는 정보 입력하기
								$("#reply_write_contents_0"+i).attr('name','contents');
							}
							/* if($("#status_cd").attr('value') !='06' || $("#status_cd").attr('value') !='07'){
		    		    		$("#reply_write_contents_0"+i).attr('name','contents');
		    		    		$('#process_no_0'+i).attr('name','process_no'); //인덱스에 해당하는 정보 입력하기
							} */
	    		    		
	    		    	}else{ //새로 입력시 
	    		    		//파라미터때문에 탭 삭제해야함
	    		    		if($("#status_cd").val()=='01'){
		    					 $("#tabs-2").remove();
		    	        		$("#tabs-3").remove();
		    	        		$("#tabs-4").remove();
		    	        		$("#tabs-5").remove(); 
		    	        		
		    	        	}else if($("#status_cd").val()=='02'){ //ip확정인경우
		    	        		$("#tabs-3").remove();
		    	        		$("#tabs-4").remove();
		    	        		$("#tabs-5").remove();
		    	        		
		    	        	}else{ 
		    	        		$("#tabs-1").remove();
		    	        		
		    	        	}
	    		    	
	    		    		$("#modelInfoForm").attr('action','process_write');		//action주소 변경
	    		    		$("#reply_write_contents_0"+i).attr('name','contents');
	    		    		$("#olt_user_id").remove();
	    		    		
	    		    		if(Chkval=='rejectBtn'){ //반려 버튼을 누른경우
		    	        		$("#prev_status").attr("value",$("#status_cd").val());
		    	        		$("#status_cd").attr('value','99');
		    	        	}else{
		    	        		$("#prev_status").remove();
		    	        	}
	    		    		
	    		    		//return;
	    		    		
	    		    	}
							$("#modelInfoForm").submit();
	   			    		
	    			}
	    		},
	    		{
	    			text: "취소",
	    			click: function() {
	    				$( this ).dialog( "close" );
	    				
	    			}
	    		}
	    	]
	    });
		
		  //착공준공등록
	    $( "#dialog_construct" ).dialog({
	    	autoOpen: false,
	    	width: 400,
	    	buttons: [
	    		{
	    			text: "YES",
	    			click: function() {
	    				//상위 폼 지우고 시작
	    				 $.blockUI();
	    				$("#modelInfoForm").remove();
	    				
	    				if('${requestView.status_cd}'=="07"){
	    					/* if($("#ed_dt").val() == null || $("#ed_dt").val() == ''){
	        			    	alert("준공일은 반드시 입력해야 합니다.");
	        			    	$( this ).dialog( "close" );
	        			    	return;
	        			    } */
	        			    if($(this).attr('name') == 's_construct'){
	        			    	if($("#st_dt").val() == null || $("#st_dt").val() == ''){
		        			    	alert("착공일은 반드시 입력해야 합니다.");
		        			    	$.unblockUI();
		        			    	$( this ).dialog( "close" );
		        			    	return;
		        			    }
								$("#contents").val($("#const_st_desc").val());
								$('#process_no_06').attr('name','process_no'); //인덱스에 해당하는 정보 입력하기
	        			    	$("#gubun").val("03");
	        			    }else{
	        					var i = parseInt($("#tabs").tabs('option','active')+1);	//현재 선택된 탭의 인덱스 알아내기
	        					
	        			    	if($('#tabs-'+i+' #constBtn').val()=='수정'){
	        			    		$('#process_no_07').attr('name','process_no');
	        			    	}else if($(this).attr('name')=='재발송'){
	    							//현재선택된 탭의 단계로 셋팅해주어야함
	    						//	$("#status_cd").attr('value','0'+i);
	    							$("#modelInfoForm").attr('action','reWriteMail');		//action주소 변경
	    	    		    		
	    	    		    	}
	        			    		$("#contents").val($("#const_ed_desc").val());
		    						$("#gubun").val("02");
	        			    }
	        			    	
	        			    //alert($("#contents").val());
	 						
	    					$("#tot_expense").val($("#tot_expense").val().replace(/\,/g,''));
	    					$("#expense1").val($("#expense1").val().replace(/\,/g,''));
	    					$("#expense2").val($("#expense2").val().replace(/\,/g,''));
	    					$("#expense3").val($("#expense3").val().replace(/\,/g,''));
	    					$("#constructForm").submit();
	    					
	    				}else if('${requestView.status_cd}'=="06"){
	    					var i = parseInt($("#tabs").tabs('option','active')+1+4);	//[1차오픈]  이후에+4빼기
	    					if($(this).attr('class')=='수정'){
	    				    	$("#gubun").val("03");
	    						$('#process_no_06').attr('name','process_no'); //인덱스에 해당하는 정보 입력하기
	    					}else if($(this).attr('class')=='재발송'){
								$("#constructForm").attr('action','reWriteMail');		//action주소 변경
	    						$('#process_no_06').attr('name','process_no'); //인덱스에 해당하는 정보 입력하기
		    		    		
		    		    	}else{
		    					$("#cnstEdDiv").remove();
	    					}
	    					
	    					var const_no = $("#const_no").val();
	    					if(!const_no){
	    						$("#const_no").attr('value','0');
	    					}
	    					
			    			$("#contents").val($("#const_st_desc").val());
	    					$("#constructForm").submit();
	    				}
	    			    
	    			}
	    		},
	    		{
	    			text: "Cancle",
	    			click: function() {
	    				$( this ).dialog( "close" );
	    				
	    			}
	    		}
	    	]
	    });
	});
    
	  //<![CDATA[
    function wrapWindowByMask(){
 
        //화면의 높이와 너비를 구한다.
        
        var maskHeight = $(document).height();  
        var maskWidth = $(document).width();  
        //마스크의 높이와 너비를 화면 것으로 만들어 전체 화면을 채운다.
        $("#mask").css({"width":maskWidth,"height":maskHeight});  
        $(".window").css({"top": (($(window).height()-$(".window").outerHeight())/2+$(window).scrollTop())+"px",
        	"left": (($(window).width()-$(".window").outerWidth())/2+$(window).scrollLeft())+"px",
        	"display":"inline-block","vertical-align":"middle"});  
        $("body").css("overflow","hidden");//body 스크롤바 없애기
        //애니메이션 효과 - 일단 0초동안 까맣게 됐다가 60% 불투명도로 간다.
       // $("#mask").fadeIn(0);      
        $("#mask").fadeTo("fast",0.6);    
 
        $(".window").show();
 		$(".window #emp_name").focus();
    }
 
    $(document).ready(function(){
        //검은 막 띄우기
        $("button[name=usrSearchBtn]").click(function(e){
        	
        	var btn_idx=$(this).attr('id').split('_');
        	$(".window #confirm_no").val(btn_idx[1]);
        	$(".window #w_gubun").val("request_view");
        	//alert(btn_idx[1]);
        	
            e.preventDefault();
            wrapWindowByMask();
        });
 
        //닫기 버튼을 눌렀을 때
        $(".window .close").click(function (e) {  
            //링크 기본동작은 작동하지 않도록 한다.
            e.preventDefault();  
            $("#mask, .window").hide();  
        });       
 
        //검은 막을 눌렀을 때
        $("#mask").click(function () {  
            closeSearchPop();
 
        });   
        
        closeSearchPop = function(){
        	 $("body").css("overflow","auto");//body 스크롤바 생성
        	 $("#mask").hide();
        	 $(".window input").val(''); 
             $(".window #bodyResult tr").remove(); 
             $(".window #notice span").remove();
             $(".window").hide(); 
        }
 
    });

</script>
</body>

</html>